#
# Start at "2022-W27-Jul07-0901-15-CEST"
#
# Version information:
# European Spallation Source ERIC : iocsh (4.0.0-PID-25019)
#
# --->--> snip -->--> 
# Please Use Version and other environment variables
# in order to report or debug this shell
#
# HOSTDISPLAY=""
# WINDOWID=""
# PWD="/home/anderssandstrom/sources/ecmc_mtca_mrf_test/iocsh_real"
# USER="anderssandstrom"
# LOGNAME="anderssandstrom"
# EPICS_HOST_ARCH="linux-x86_64"
# EPICS_BASE="/epics/base-7.0.6.1"
# E3_REQUIRE_NAME="require"
# E3_REQUIRE_VERSION="4.0.0"
# E3_REQUIRE_LOCATION="/epics/base-7.0.6.1/require/4.0.0"
# E3_REQUIRE_BIN="/epics/base-7.0.6.1/require/4.0.0/bin"
# E3_REQUIRE_DB="/epics/base-7.0.6.1/require/4.0.0/db"
# E3_REQUIRE_DBD="/epics/base-7.0.6.1/require/4.0.0/dbd"
# E3_REQUIRE_INC="/epics/base-7.0.6.1/require/4.0.0/include"
# E3_REQUIRE_LIB="/epics/base-7.0.6.1/require/4.0.0/lib"
# EPICS_DRIVER_PATH="/epics/base-7.0.6.1/require/4.0.0/siteMods"
# EPICS_CA_AUTO_ADDR_LIST=""
# EPICS_CA_ADDR_LIST=""
# EPICS_PVA_AUTO_ADDR_LIST=""
# EPICS_PVA_ADDR_LIST=""
# PATH="/epics/base-7.0.6.1/require/4.0.0/bin:/epics/base-7.0.6.1/bin/linux-x86_64:/usr/condabin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/anderssandstrom/.local/bin:/home/anderssandstrom/bin"
# --->--> snip -->--> 
#
# Set REQUIRE_IOC for its internal PVs
epicsEnvSet REQUIRE_IOC "REQMOD:lab-mot-ctrl-cp-25019"
#
# Enable an exit subroutine for sotfioc
dbLoadRecords "/epics/base-7.0.6.1/db/softIocExit.db" "IOC=REQMOD:lab-mot-ctrl-cp-25019"
#
# Set E3_IOCSH_TOP for the absolute path where iocsh is executed.
epicsEnvSet E3_IOCSH_TOP "/home/anderssandstrom/sources/ecmc_mtca_mrf_test/iocsh_real"
#
# 
# Load require module, which has the version 4.0.0
# 
dlload /epics/base-7.0.6.1/require/4.0.0/lib/linux-x86_64/librequire.so
dbLoadDatabase /epics/base-7.0.6.1/require/4.0.0/dbd/require.dbd
require_registerRecordDeviceDriver
Loading module info records for require
# 
# Set E3_CMD_TOP for the absolute path where ecmc_lean_test.script exists
epicsEnvSet E3_CMD_TOP "/home/anderssandstrom/sources/ecmc_mtca_mrf_test/iocsh_real"
#
iocshLoad 'ecmc_lean_test.script',''
##############################################################################
## Initiation:
epicsEnvSet("IOC" ,"IOC_MTCA")
epicsEnvSet("ECMCCFG_INIT" ,"")  #Only run startup once (auto at PSI, need call at ESS), variable set to "#" in startup.cmd
epicsEnvSet("SCRIPTEXEC" ,"iocshLoad")
# Configure ecmc
require ecmccfg ruckig
Module ecmccfg version ruckig found in /home/anderssandstrom/sources/e3-ecmccfg/cellMods//base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/
Loading library /home/anderssandstrom/sources/e3-ecmccfg/cellMods//base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/lib/linux-x86_64/libecmccfg.so
Loaded ecmccfg version ruckig
Loading dbd file /home/anderssandstrom/sources/e3-ecmccfg/cellMods//base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/dbd/ecmccfg.dbd
Calling function ecmccfg_registerRecordDeviceDriver
Loading module info records for ecmccfg
require mcoreutils
Module mcoreutils version 1.2.2+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/mcoreutils/1.2.2+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/mcoreutils/1.2.2+0/lib/linux-x86_64/libmcoreutils.so
Loaded mcoreutils version 1.2.2+0
Loading dbd file /epics/base-7.0.6.1/require/4.0.0/siteMods/mcoreutils/1.2.2+0/dbd/mcoreutils.dbd
Calling function mcoreutils_registerRecordDeviceDriver
MCoreUtils version 1.2.2+0
MCoreUtils: Read 0 thread rule(s) from /etc/rtrules
MCoreUtils: Read 0 thread rule(s) from /home/anderssandstrom/.rtrules
Loading module info records for mcoreutils
mcoreThreadRuleAdd ecmc * * 1 ecmc_rt
# run module startup.cmd (only needed at ESS  PSI auto call at require)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/startup.cmd, "IOC=IOC_MTCA,ECMC_VER=ecmc_mrf,EC_RATE=1000"
#==============================================================================
# startup.cmd
on error halt
require ecmc        "ecmc_mrf"
Module ecmc version ecmc_mrf found in /home/anderssandstrom/sources/e3-ecmc/cellMods//base-7.0.6.1/require-4.0.0/ecmc/ecmc_mrf/
Module ecmc depends on asyn 4.42.0+0
Module asyn version 4.42.0+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/asyn/4.42.0+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/asyn/4.42.0+0/lib/linux-x86_64/libasyn.so
Loaded asyn version 4.42.0+0
Loading dbd file /epics/base-7.0.6.1/require/4.0.0/siteMods/asyn/4.42.0+0/dbd/asyn.dbd
Calling function asyn_registerRecordDeviceDriver
Loading module info records for asyn
Module ecmc depends on exprtk 1.2.1+0
Module exprtk version 1.2.1+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/exprtk/1.2.1+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/exprtk/1.2.1+0/lib/linux-x86_64/libexprtk.so
Loaded exprtk version 1.2.1+0
exprtk has no dbd file
Loading module info records for exprtk
Module ecmc depends on motor 7.0.7+0
Module motor version 7.0.7+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/motor/7.0.7+0/
Module motor depends on asyn 4.42.0+0
Module asyn version 4.42.0+0 already loaded
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/motor/7.0.7+0/lib/linux-x86_64/libmotor.so
Loaded motor version 7.0.7+0
Loading dbd file /epics/base-7.0.6.1/require/4.0.0/siteMods/motor/7.0.7+0/dbd/motor.dbd
Calling function motor_registerRecordDeviceDriver
Loading module info records for motor
Module ecmc depends on ruckig 1.0.0+0
Module ruckig version 1.0.0+0 found in /epics/base-7.0.6.1/require/4.0.0/siteMods/ruckig/1.0.0+0/
Loading library /epics/base-7.0.6.1/require/4.0.0/siteMods/ruckig/1.0.0+0/lib/linux-x86_64/libruckig.so
Loaded ruckig version 1.0.0+0
ruckig has no dbd file
Loading module info records for ruckig
Loading library /home/anderssandstrom/sources/e3-ecmc/cellMods//base-7.0.6.1/require-4.0.0/ecmc/ecmc_mrf/lib/linux-x86_64/libecmc.so
Loaded ecmc version ecmc_mrf
Loading dbd file /home/anderssandstrom/sources/e3-ecmc/cellMods//base-7.0.6.1/require-4.0.0/ecmc/ecmc_mrf/dbd/ecmc.dbd
Calling function ecmc_registerRecordDeviceDriver
Loading module info records for ecmc
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'ecmcMotorRecord'='EthercatMC'", "require  EthercatMC 3.0.2 # Using EthercatMC motor record support.","# Using ecmcMotorRecord motor record support.")
# Using ecmcMotorRecord motor record support.
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_CONFIG_ROOT",     "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/")
epicsEnvSet("ECMC_CONFIG_DB",       "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/db/")
epicsEnvSet("SCRIPTEXEC",           "iocshLoad")
epicsEnvSet("SM_PREFIX",            "IOC_MTCA:")    # colon added since IOC is _not_ PREFIX
epicsEnvSet("ECMC_PROC_HOOK",       "")
epicsEnvSet(ECMC_MODE, FULL)
ecmcEpicsEnvSetCalcTernary(ECMC_SUPPORT_MOTION, "'FULL'!='DAQ'","","# MODE == DAQ, DISABLING MOTION.")
epicsEnvShow(ECMC_SUPPORT_MOTION)
ECMC_SUPPORT_MOTION=
ecmcEpicsEnvSetCalcTernary(ECMC_USE_MOTOR_RECORD, "'FULL'=='FULL'","","# MODE != FULL, DISABLING MOTOR RECORD.")
epicsEnvShow(ECMC_USE_MOTOR_RECORD)
ECMC_USE_MOTOR_RECORD=
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/initAll.cmd",1)
iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/initAll.cmd"
#==============================================================================
# initAll.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/init.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/init.cmd
#==============================================================================
# init.cmd
epicsEnvSet("ECMC_ASYN_TIMEOUT",      1)                   # Asyn timeout
epicsEnvSet("ECMC_ASYN_ADDR",         0)                   # Asyn Address
epicsEnvSet("ECMC_MOTOR_PORT",        "NOT SET")
epicsEnvSet("ECMC_ASYN_PORT",         "NOT SET")
epicsEnvSet("ECMC_PREFIX",            "NOT SET")
epicsEnvSet("ECMC_GEN_EC_RECORDS",    "NOT SET")
epicsEnvSet("ECMC_GEN_AX_RECORDS",    "NOT SET")
epicsEnvSet("ECMC_EC_AXIS_HEALTH",    "NOT SET")
epicsEnvSet("ECMC_PLC_SAMPLE_RATE_MS", "NOT SET")
epicsEnvSet("ECMC_TSE",               -2)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/initAxis.cmd",1)
iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/initAxis.cmd"
#==============================================================================
# initAxis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_unset.cmd",1)
iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_unset.cmd"
#==============================================================================
# ecmc_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_CNTRL_KP)
epicsEnvUnset(ECMC_CNTRL_KI)
epicsEnvUnset(ECMC_CNTRL_KD)
epicsEnvUnset(ECMC_CNTRL_KFF)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_EC_ENC_LATCHPOS)
epicsEnvUnset(ECMC_EC_ENC_LATCH_CONTROL)
epicsEnvUnset(ECMC_EC_ENC_LATCH_STATUS)
epicsEnvUnset(ECMC_HOME_LATCH_COUNT_OFFSET)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_DRV_CONTROL)
epicsEnvUnset(ECMC_EC_DRV_STATUS)
epicsEnvUnset(ECMC_EC_DRV_VELOCITY)
epicsEnvUnset(ECMC_EC_DRV_BRAKE)
epicsEnvUnset(ECMC_EC_DRV_REDUCE_TORQUE)
epicsEnvUnset(ECMC_EC_DRV_RESET)
epicsEnvUnset(ECMC_EC_DRV_ALARM_0)
epicsEnvUnset(ECMC_EC_DRV_ALARM_1)
epicsEnvUnset(ECMC_EC_DRV_ALARM_2)
epicsEnvUnset(ECMC_EC_DRV_WARNING)
epicsEnvUnset(ECMC_DRV_SCALE_DENOM)
epicsEnvUnset(ECMC_DRV_SCALE_NUM)
epicsEnvUnset(ECMC_DRV_BRAKE_OPEN_DLY_TIME)
epicsEnvUnset(ECMC_DRV_BRAKE_CLOSE_AHEAD_TIME)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_DXLM_ENABLE)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_DXLM_ENABLE)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_sync_unset.cmd",1)
iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_sync_unset.cmd"
#============================================================================2022/07/07 09:01:15.555 
ECMC Initializes.............
2022/07/07 09:01:15.555 ESS Open Source EtherCAT Motion Control Epics Module2022/07/07 09:01:15.555 
Mode: Configuration
2022/07/07 09:01:15.555 OK
2022/07/07 09:01:15.555 OK
2022/07/07 09:01:15.555 OK
2022/07/07 09:01:15.557 OK
2022/07/07 09:01:15.579 OK
2022/07/07 09:01:15.579 OK
==
# ecmc_axis_sync_unset.cmd
epicsEnvUnset(ECMC_CMD_FRM_OTHER_PLC_ENABLE)
epicsEnvUnset(ECMC_CMD_AXIS_PLC_ENABLE)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_1)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_2)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_3)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_4)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_5)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_6)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_7)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_8)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_9)
epicsEnvUnset(ECMC_AXIS_EXPR_LINE_10)
epicsEnvUnset(ECMC_ENC_VELO_FILT_SIZE)
epicsEnvUnset(ECMC_ENC_VELO_FILT_ENABLE)
epicsEnvUnset(ECMC_ENC_SOURCE)
epicsEnvUnset(ECMC_TRAJ_VELO_FILT_SIZE)
epicsEnvUnset(ECMC_TRAJ_VELO_FILT_ENABLE)
epicsEnvUnset(ECMC_TRAJ_SOURCE)
epicsEnvSet("ECMC_EGU",               "mm")
epicsEnvSet("ECMC_PREC",              3)
epicsEnvSet("ECMC_AXISFIELDINIT",     "")                  # Extra field init to motor record
epicsEnvSet("ECMC_AXISCONFIG",        "")                  # Extra parameters to driver
############################################################
############# ASYN Configuration:
epicsEnvSet("ECMC_MOTOR_PORT"     "MCU1")
epicsEnvSet("ECMC_ASYN_PORT"      "MC_CPU1")
epicsEnvSet("ECMC_PREFIX"         "IOC_MTCA:")
ecmcAsynPortDriverConfigure(MC_CPU1,1000,0,0,100)
ecmcAsynPortDriverConfigure: portName = MC_CPU1, paramTableSize = 1000, disableAutoConnect = 0, priority = 0, defaultSampleRateMS = 100.000000
asynOctetSetOutputEos(MC_CPU1, -1, ";\n")
asynOctetSetInputEos(MC_CPU1, -1, ";\n")
asynSetTraceMask(MC_CPU1, -1, 0x41)
asynSetTraceIOMask(MC_CPU1, -1, 6)
asynSetTraceInfoMask(MC_CPU1, -1, 1)
ecmcMotorRecordCreateController(MCU1, MC_CPU1, "64", 200, 1000, "")
############################################################
############# Misc settings:
# Disable function call trace printouts
ecmcConfigOrDie "Cfg.SetEnableFuncCallDiag(0)"
# Disable on change printouts from objects (enable for easy logging)
ecmcConfigOrDie "Cfg.SetTraceMaskBit(15,0)"
# Choose to generate EPICS-records for EtherCAT-entries
# (For records use ECMC_GEN_EC_RECORDS="-records" otherwise ECMC_GEN_EC_RECORDS="")
epicsEnvSet("ECMC_GEN_EC_RECORDS",          "-records")
# Choose to generate EPICS-records for ax-entries (PosAct, SetPos,..)
# (For records use ECMC_GEN_AX_RECORDS="-records" otherwise ECMC_GEN_AX_RECORDS="")
epicsEnvSet("ECMC_GEN_AX_RECORDS",          "-records")
# suffix for pva enabled scripts, templates and substitutions
ecmcEpicsEnvSetCalcTernary(ECMC_PVA, "0", "Pva","")
# Set EtherCAT frequency (defaults to 1000)
ecmcConfigOrDie "Cfg.SetSampleRate(1000)"
epicsEnvSet("ECMC_EC_SAMPLE_RATE" ,   1000)
ecmcEpicsEnvSetCalc("ECMC_EC_SAMPLE_RATE_MS" ,1000/1000)
# Update records in 10ms (100Hz) for FULL MODE and in EC_RATE for DAQ mode
ecmcEpicsEnvSetCalcTernary(ECMC_SAMPLE_RATE_MS, "'FULL'=='DAQ'","1","10")
epicsEnvSet("ECMC_P_SCRIPT",        "mXsXXX")
ecmcEpicsEnvSetCalcTernary(ECMC_MASTER_CMD, "0>=0", "","#- ")
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addMaster.cmd",1)
 iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addMaster.cmd", "MASTER_ID=0"
#===============================================================================
# addMaster.cfg
epicsEnvSet("ECMC_EC_MASTER_ID"          "0")
# Claim master
ecmcConfigOrDie "Cfg.EcSetMaster(0)"
epicsEnvSet("ECMC_EC_MASTER_ID" ,0)
epicsEnvSet("ECMC_TMP_DIR",         "/tmp/IOC_MTCA/EcMaster_0/")
system "mkdir -p /tmp/IOC_MTCA/EcMaster_0/"
epicsEnvSet("ECMC_TMP_DIR",         "/tmp/IOC_MTCA/EcMaster_0/")
system "mkdir -p /tmp/IOC_MTCA/EcMaster_0/"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/setDiagnostics.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/setDiagnostics.cmd
#==============================================================================
# setDiagnostics.cmd
ecmcConfigOrDie "Cfg.EcSetDiagnostics(1)"
ecmcConfigOrDie "Cfg.EcEnablePrintouts(0)"
ecmcConfigOrDie "Cfg.EcSetDomainFaile2022/07/07 09:01:15.579 OK
2022/07/07 09:01:15.579 OK
2022/07/07 09:01:15.580 OK
2022/07/07 09:01:15.580 OK
2022/07/07 09:01:15.580 OK
2022/07/07 09:01:15.580 OK
2022/07/07 09:01:15.580 OK
2022/07/07 09:01:15.580 OK
2022/07/07 09:01:15.580 OK
2022/07/07 09:01:15.580 OK
dCyclesLimit(100)"
epicsEnvSet("ECMCCFG_INIT" ,"#")
# Note NELM equals oversampling factor in this case. Use +-320mv Config file for all 4 channels
epicsEnvSet("NELM",              "20")
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "2")
epicsEnvSet("ECMC_SAMPLE_RATE_MS", 0)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addSlave.cmd, "SLAVE_ID=2, HW_DESC=EL1252"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "2")
epicsEnvSet("HW_DESC",            "EL1252")
epicsEnvSet("P_SCRIPT",           "mXsXXX")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmcEL1252.cmd",1)
iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmcEL1252.cmd" "NELM=20"
epicsEnvSet("ECMC_EC_HWTYPE"             "EL1252")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x04e43052")
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/slaveVerify.cmd
ecmcEpicsEnvSetCalcTernary(SLAVE_VERIFY, "0==0","","#- ")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,2,0x2,0x04e43052)"
ecmcEpicsEnvSetCalcTernary(SLAVE_RESET, "0>0","","#- ")
epicsEnvSet(ECMC_EC_SLAVE_FW, "0x0000")
ecmcEpicsEnvSetCalcTernary(SLAVE_FW, "0>0","","#- ")
epicsEnvUnset(SLAVE_VERIFY)
epicsEnvUnset(SLAVE_RESET)
epicsEnvUnset(SLAVE_FW)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmcEX1002.cmd
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x2,0x04e43052,2,0,0x1a00,0x6000,0x1,B1,binaryInput01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x2,0x04e43052,2,0,0x1a01,0x6010,0x1,B1,binaryInput02)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xae,U8,status01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xaf,U8,status02)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xb0,U64,timestampLatchPositive01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xb8,U64,timestampLatchNegative01)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xc0,U64,timestampLatchPositive02)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(2,0x2,0x04e43052,2,1,0x1a13,0x1d09,0xc8,U64,timestampLatchNegative02)"
# deduce what the prefix should be
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmcmXsXXX.cmd",1)
iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmcmXsXXX.cmd" "MASTER_ID=0,SLAVE_POS=2,HWTYPE=EL1252"
#==============================================================================
# ecmcmXsXXX.cmd
ecmcEpicsEnvSetCalc("sid", "2","%03d")
ecmcEpicsEnvSetCalc("mid", "0","%01d")
epicsEnvSet("ECMC_G",            "IOC_MTCA:m0s002")
epicsEnvSet("ECMC_P",            "IOC_MTCA:m0s002-")
epicsEnvUnset(sid)
epicsEnvUnset(mid)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SUBS, "True", "","#- ")
iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/applySubstitutions.cmd" "SUBST_FILE=ecmcEL1252.substitutions,ECMC_P=IOC_MTCA:m0s002-"
#==============================================================================
# applySubstitutions.cmd
ecmcFileExist(ecmcEL1252.substitutions,1,1)
dbLoadTemplate(ecmcEL1252.substitutions,"ECMC_P=IOC_MTCA:m0s002-,ECMC_G=IOC_MTCA:m0s002,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=2,HWTYPE=EL1252,T_SMP_MS=0,TSE=-2,NELM=20")
epicsEnvUnset(DEFAULT_SUBS)
ecmcEpicsEnvSetCalcTernary(DEFAULT_SLAVE_PVS, "True", "","#- ")
iocshLoad "/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/applyTemplate.cmd" "TEMPLATE_FILE=ecmcEcSlave.template,ECMC_P=IOC_MTCA:m0s002-,ECMC_G=IOC_MTCA:m0s002"
#==============================================================================
# applyTemplate.cmd
ecmcFileExist(ecmc2022/07/07 09:01:15.604 OK
2022/07/07 09:01:15.604 OK
2022/07/07 09:01:15.607 OK
EcSlave.template,1,1)
dbLoadRecords("ecmcEcSlave.template", "ECMC_P=IOC_MTCA:m0s002-,ECMC_G=IOC_MTCA:m0s002,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=2,HWTYPE=EL1252,T_SMP_MS=0,TSE=-2,")
epicsEnvUnset(DEFAULT_SLAVE_PVS)
# increment SLAVE_ID
ecmcEpicsEnvSetCalc("SLAVE_ID", "2+1","%d")
epicsEnvSet("ECMC_SAMPLE_RATE_MS", 10)
#Apply hardware configuration
ecmcConfigOrDie "Cfg.EcApplyConfig(1)"
# Use CLOCK_REALTIME
ecmcConfigOrDie "Cfg.EcUseClockRealtime(1)"
ecmcConfigOrDie "Cfg.EcSelectReferenceDC(0,2)"
epicsEnvSet("DEV",      "IOC_MTCA")
epicsEnvSet("ID",       "1")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=1)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis1")
epicsEnvSet("ECMC_R",                     "Axis1-")
epicsEnvSet("ECMC_AXIS_NO",               "1")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (1)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting 2022/07/07 09:01:15.610 OK
2022/07/07 09:01:15.610 OK
2022/07/07 09:01:15.610 OK
2022/07/07 09:01:15.610 OK
2022/07/07 09:01:15.610 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.611 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
2022/07/07 09:01:15.612 OK
is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(1,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(1,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(1, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(1, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(1,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(1,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(1,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(1,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(1,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(1,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax1.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(1,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(1,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(1,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(1,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(1,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(1,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(1,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(1,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(1,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax1.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax1.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax1.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax1.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax1.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(1,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(1,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(1,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(1,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(1,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(1,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(1,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(1,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(1,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(1,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(1,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(1,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(1,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(1,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(1,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(1,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(1,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(1, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(1, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e32022/07/07 09:01:15.612 ecmcMotorRecord:: setIntegerParam(1 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.612 ecmcMotorRecord:: setDoubleParam(1 motorPowerOnDelay_)=6
2022/07/07 09:01:15.612 ecmcMotorRecord:: setDoubleParam(1 motorPowerOffDelay_=-1
2022/07/07 09:01:15.612 ecmcMotorRecord:: connected(1)
2022/07/07 09:01:15.612 ecmcMotorRecord:: initialPoll(1) status=0
-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "1", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis1, MOTOR_PORT=MCU1, AXIS_NO=1, DESC=MCU1025 Center Position (1), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis1, MOTOR_PORT=MCU1, AXIS_NO=1,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis1,AXIS_NO=1,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis1,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "2")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=2)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis2")
epicsEnvSet("ECMC_R",                     "Axis2-")
epicsEnvSet("ECMC_AXIS_NO",               "2")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (2)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnv2022/07/07 09:01:15.639 OK
2022/07/07 09:01:15.639 OK
2022/07/07 09:01:15.639 OK
2022/07/07 09:01:15.639 OK
2022/07/07 09:01:15.639 OK
Set("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(2,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(2,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(2, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(2, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_S2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.640 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 OK
2022/07/07 09:01:15.641 ecmcMotorRecord:: setIntegerParam(2 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.641 ecmcMotorRecord:: setDoubleParam(2 motorPowerOnDelay_)=6
2022/07/07 09:01:15.641 ecmcMotorRecord:: setDoubleParam(2 motorPowerOffDelay_=-1
2022/07/07 09:01:15.641 ecmcMotorRecord:: connected(2)
2022/07/07 09:01:15.641 ecmcMotorRecord:: initialPoll(2) status=0
TR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(2,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(2,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(2,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(2,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(2,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(2,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax2.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(2,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(2,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(2,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(2,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(2,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(2,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(2,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(2,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(2,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax2.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax2.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax2.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax2.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax2.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(2,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(2,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(2,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(2,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(2,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(2,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(2,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(2,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(2,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(2,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(2,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(2,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(2,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(2,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(2,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(2,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(2,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(2, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(2, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "2", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis2, MOTOR_PORT=MCU1, AXIS_NO=2, DESC=MCU1025 Center Position (2), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis2, MOTOR_PORT=MCU1, AXIS_NO=2,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis2,AXIS_NO=2,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis2,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "3")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=3)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis3")
epicsEnvSet("ECMC_R",                     "Axis3-")
epicsEnvSet("ECMC_AXIS_NO",               "3")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (3)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccf2022/07/07 09:01:15.647 OK
2022/07/07 09:01:15.647 OK
2022/07/07 09:01:15.647 OK
2022/07/07 09:01:15.647 OK
2022/07/07 09:01:15.647 OK
2022/07/07 09:01:15.647 OK
2022/07/07 09:01:15.648 OK
g/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(3,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(3,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(3, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(3, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(3,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(3,0)"
ecmcConfigOrDie "Cfg.S2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.648 OK
2022/07/07 09:01:15.649 OK
2022/07/07 09:01:15.649 OK
2022/07/07 09:01:15.649 OK
2022/07/07 09:01:15.649 OK
2022/07/07 09:01:15.649 OK
2022/07/07 09:01:15.649 OK
2022/07/07 09:01:15.649 OK
2022/07/07 09:01:15.649 OK
2022/07/07 09:01:15.649 ecmcMotorRecord:: setIntegerParam(3 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.649 ecmcMotorRecord:: setDoubleParam(3 motorPowerOnDelay_)=6
2022/07/07 09:01:15.649 ecmcMotorRecord:: setDoubleParam(3 motorPowerOffDelay_=-1
2022/07/07 09:01:15.649 ecmcMotorRecord:: connected(3)
2022/07/07 09:01:15.649 ecmcMotorRecord:: initialPoll(3) status=0
etAxisVel(3,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(3,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(3,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(3,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax3.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(3,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(3,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(3,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(3,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(3,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(3,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(3,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(3,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(3,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax3.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax3.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax3.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax3.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax3.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(3,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(3,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(3,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(3,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(3,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(3,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(3,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(3,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(3,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(3,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(3,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(3,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(3,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(3,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(3,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(3,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(3,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(3, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(3, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "3", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis3, MOTOR_PORT=MCU1, AXIS_NO=3, DESC=MCU1025 Center Position (3), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis3, MOTOR_PORT=MCU1, AXIS_NO=3,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis3,AXIS_NO=3,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis3,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "4")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=4)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis4")
epicsEnvSet("ECMC_R",                     "Axis4-")
epicsEnvSet("ECMC_AXIS_NO",               "4")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (4)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cm2022/07/07 09:01:15.654 OK
2022/07/07 09:01:15.654 OK
2022/07/07 09:01:15.654 OK
2022/07/07 09:01:15.654 OK
2022/07/07 09:01:15.654 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
2022/07/07 09:01:15.655 OK
d",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(4,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(4,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(4, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(4, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(4,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(4,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(4,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(4,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(4,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(4,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax4.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(4,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(4,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(4,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(4,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(4,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(4,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(4,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(4,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(4,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.enc.alarm0"2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 OK
2022/07/07 09:01:15.656 ecmcMotorRecord:: setIntegerParam(4 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.656 ecmcMotorRecord:: setDoubleParam(4 motorPowerOnDelay_)=6
2022/07/07 09:01:15.656 ecmcMotorRecord:: setDoubleParam(4 motorPowerOffDelay_=-1
2022/07/07 09:01:15.656 ecmcMotorRecord:: connected(4)
2022/07/07 09:01:15.656 ecmcMotorRecord:: initialPoll(4) status=0
)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax4.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax4.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax4.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax4.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax4.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(4,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(4,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(4,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(4,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(4,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(4,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(4,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(4,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(4,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(4,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(4,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(4,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(4,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(4,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(4,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(4,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(4,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(4, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(4, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "4", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis4, MOTOR_PORT=MCU1, AXIS_NO=4, DESC=MCU1025 Center Position (4), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis4, MOTOR_PORT=MCU1, AXIS_NO=4,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis4,AXIS_NO=4,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis4,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "5")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=5)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis5")
epicsEnvSet("ECMC_R",                     "Axis5-")
epicsEnvSet("ECMC_AXIS_NO",               "5")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (5)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcEx2022/07/07 09:01:15.662 OK
2022/07/07 09:01:15.662 OK
2022/07/07 09:01:15.662 OK
2022/07/07 09:01:15.662 OK
2022/07/07 09:01:15.662 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
it Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(5,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(5,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(5, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(5, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(5,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(5,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(5,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(5,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(5,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(5,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax5.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(5,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(5,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(5,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(5,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(5,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(5,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(5,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(5,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(5,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax5.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax5.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax5.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax5.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax5.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(5,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(5,1002022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.663 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 OK
2022/07/07 09:01:15.664 ecmcMotorRecord:: setIntegerParam(5 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.664 ecmcMotorRecord:: setDoubleParam(5 motorPowerOnDelay_)=6
2022/07/07 09:01:15.664 ecmcMotorRecord:: setDoubleParam(5 motorPowerOffDelay_=-1
2022/07/07 09:01:15.664 ecmcMotorRecord:: connected(5)
2022/07/07 09:01:15.664 ecmcMotorRecord:: initialPoll(5) status=0
)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(5,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(5,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(5,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(5,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(5,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(5,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(5,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(5,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(5,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(5,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(5,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(5,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(5,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(5,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(5,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(5, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(5, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "5", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis5, MOTOR_PORT=MCU1, AXIS_NO=5, DESC=MCU1025 Center Position (5), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis5, MOTOR_PORT=MCU1, AXIS_NO=5,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis5,AXIS_NO=5,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis5,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "6")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=6)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis6")
epicsEnvSet("ECMC_R",                     "Axis6-")
epicsEnvSet("ECMC_AXIS_NO",               "6")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (6)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad 2022/07/07 09:01:15.669 OK
2022/07/07 09:01:15.669 OK
2022/07/07 09:01:15.669 OK
2022/07/07 09:01:15.669 OK
2022/07/07 09:01:15.669 OK
2022/07/07 09:01:15.670 OK
2022/07/07 09:01:15.670 OK
2022/07/07 09:01:15.670 OK
2022/07/07 09:01:15.670 OK
2022/07/07 09:01:15.670 OK
2022/07/07 09:01:15.670 OK
2022/07/07 09:01:15.670 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.671 OK
/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(6,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(6,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(6, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(6, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(6,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(6,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(6,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(6,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(6,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(6,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax6.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(6,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(6,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(6,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(6,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(6,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(6,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(6,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(6,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(6,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax6.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax6.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax6.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax6.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax6.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(6,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(6,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(6,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(6,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(6,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(6,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(6,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(6,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(6,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(6,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(6,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(6,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(6,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(6,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(6,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(6,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(6,0.0)2022/07/07 09:01:15.671 OK
2022/07/07 09:01:15.672 OK
2022/07/07 09:01:15.672 OK
2022/07/07 09:01:15.672 ecmcMotorRecord:: setIntegerParam(6 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.672 ecmcMotorRecord:: setDoubleParam(6 motorPowerOnDelay_)=6
2022/07/07 09:01:15.672 ecmcMotorRecord:: setDoubleParam(6 motorPowerOffDelay_=-1
2022/07/07 09:01:15.672 ecmcMotorRecord:: connected(6)
2022/07/07 09:01:15.672 ecmcMotorRecord:: initialPoll(6) status=0
"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(6, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(6, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "6", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis6, MOTOR_PORT=MCU1, AXIS_NO=6, DESC=MCU1025 Center Position (6), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis6, MOTOR_PORT=MCU1, AXIS_NO=6,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis6,AXIS_NO=6,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis6,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "7")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=7)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis7")
epicsEnvSet("ECMC_R",                     "Axis7-")
epicsEnvSet("ECMC_AXIS_NO",               "7")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (7)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat ent2022/07/07 09:01:15.677 OK
2022/07/07 09:01:15.677 OK
2022/07/07 09:01:15.677 OK
2022/07/07 09:01:15.677 OK
2022/07/07 09:01:15.677 OK
ry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(7,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(7,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(7, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(7, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.678 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 OK
2022/07/07 09:01:15.679 ecmcMotorRecord:: setIntegerParam(7 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.679 ecmcMotorRecord:: setDoubleParam(7 motorPowerOnDelay_)=6
2022/07/07 09:01:15.679 ecmcMotorRecord:: setDoubleParam(7 motorPowerOffDelay_=-1
2022/07/07 09:01:15.679 ecmcMotorRecord:: connected(7)
2022/07/07 09:01:15.679 ecmcMotorRecord:: initialPoll(7) status=0
0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(7,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(7,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(7,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(7,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(7,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(7,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax7.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(7,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(7,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(7,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(7,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(7,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(7,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(7,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(7,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(7,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax7.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax7.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax7.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax7.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax7.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(7,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(7,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(7,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(7,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(7,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(7,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(7,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(7,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(7,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(7,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(7,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(7,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(7,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(7,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(7,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(7,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(7,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(7, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(7, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "7", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis7, MOTOR_PORT=MCU1, AXIS_NO=7, DESC=MCU1025 Center Position (7), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis7, MOTOR_PORT=MCU1, AXIS_NO=7,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis7,AXIS_NO=7,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis7,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "8")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=8)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis8")
epicsEnvSet("ECMC_R",                     "Axis8-")
epicsEnvSet("ECMC_AXIS_NO",               "8")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (8)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/c2022/07/07 09:01:15.684 OK
2022/07/07 09:01:15.684 OK
2022/07/07 09:01:15.684 OK
2022/07/07 09:01:15.684 OK
2022/07/07 09:01:15.684 OK
ellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(8,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(8,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(8, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(8, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcT2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.685 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 OK
2022/07/07 09:01:15.686 ecmcMotorRecord:: setIntegerParam(8 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.686 ecmcMotorRecord:: setDoubleParam(8 motorPowerOnDelay_)=6
2022/07/07 09:01:15.686 ecmcMotorRecord:: setDoubleParam(8 motorPowerOffDelay_=-1
2022/07/07 09:01:15.686 ecmcMotorRecord:: connected(8)
2022/07/07 09:01:15.686 ecmcMotorRecord:: initialPoll(8) status=0
ernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(8,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(8,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(8,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(8,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(8,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(8,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax8.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(8,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(8,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(8,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(8,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(8,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(8,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(8,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(8,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(8,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax8.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax8.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax8.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax8.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax8.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(8,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(8,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(8,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(8,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(8,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(8,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(8,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(8,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(8,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(8,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(8,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(8,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(8,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(8,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(8,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(8,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(8,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(8, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(8, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "8", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis8, MOTOR_PORT=MCU1, AXIS_NO=8, DESC=MCU1025 Center Position (8), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis8, MOTOR_PORT=MCU1, AXIS_NO=8,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis8,AXIS_NO=8,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis8,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "9")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=9)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis9")
epicsEnvSet("ECMC_R",                     "Axis9-")
epicsEnvSet("ECMC_AXIS_NO",               "9")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (9)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==================================================================2022/07/07 09:01:15.691 OK
2022/07/07 09:01:15.691 OK
2022/07/07 09:01:15.691 OK
2022/07/07 09:01:15.691 OK
2022/07/07 09:01:15.692 OK
2022/07/07 09:01:15.692 OK
2022/07/07 09:01:15.692 OK
2022/07/07 09:01:15.692 OK
2022/07/07 09:01:15.692 OK
2022/07/07 09:01:15.692 OK
2022/07/07 09:01:15.692 OK
2022/07/07 09:01:15.692 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
============
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(9,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(9,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(9, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(9, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(9,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(9,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(9,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(9,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(9,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(9,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax9.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(9,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(9,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(9,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(9,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(9,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(9,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(9,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(9,1)"
ecmcC2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 OK
2022/07/07 09:01:15.693 ecmcMotorRecord:: setIntegerParam(9 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.693 ecmcMotorRecord:: setDoubleParam(9 motorPowerOnDelay_)=6
2022/07/07 09:01:15.693 ecmcMotorRecord:: setDoubleParam(9 motorPowerOffDelay_=-1
2022/07/07 09:01:15.694 ecmcMotorRecord:: connected(9)
2022/07/07 09:01:15.694 ecmcMotorRecord:: initialPoll(9) status=0
onfigOrDie "Cfg.SetAxisEncPosFilterEnable(9,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax9.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax9.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax9.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax9.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax9.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(9,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(9,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(9,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(9,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(9,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(9,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(9,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(9,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(9,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(9,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(9,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(9,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(9,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(9,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(9,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(9,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(9,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(9, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(9, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "9", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis9, MOTOR_PORT=MCU1, AXIS_NO=9, DESC=MCU1025 Center Position (9), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis9, MOTOR_PORT=MCU1, AXIS_NO=9,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis9,AXIS_NO=9,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis9,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "10")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=10)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis10")
epicsEnvSet("ECMC_R",                     "Axis10-")
epicsEnvSet("ECMC_AXIS_NO",               "10")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (10)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#=========================2022/07/07 09:01:15.698 OK
2022/07/07 09:01:15.698 OK
2022/07/07 09:01:15.699 OK
2022/07/07 09:01:15.699 OK
2022/07/07 09:01:15.699 OK
2022/07/07 09:01:15.699 OK
2022/07/07 09:01:15.699 OK
2022/07/07 09:01:15.699 OK
2022/07/07 09:01:15.699 OK
2022/07/07 09:01:15.699 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
=====================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(10,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(10,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(10, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(10, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(10,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(10,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(10,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(10,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(10,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(10,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax10.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(10,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(10,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(10,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(10,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(10,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(10,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(10,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(10,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(10,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax10.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax10.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax10.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.02022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.700 OK
2022/07/07 09:01:15.701 ecmcMotorRecord:: setIntegerParam(10 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.701 ecmcMotorRecord:: setDoubleParam(10 motorPowerOnDelay_)=6
2022/07/07 09:01:15.701 ecmcMotorRecord:: setDoubleParam(10 motorPowerOffDelay_=-1
2022/07/07 09:01:15.701 ecmcMotorRecord:: connected(10)
2022/07/07 09:01:15.701 ecmcMotorRecord:: initialPoll(10) status=0
,"ax10.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax10.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(10,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(10,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(10,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(10,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(10,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(10,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(10,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(10,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(10,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(10,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(10,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(10,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(10,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(10,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(10,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(10,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(10,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(10, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(10, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "10", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis10, MOTOR_PORT=MCU1, AXIS_NO=10, DESC=MCU1025 Center Position (10), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis10, MOTOR_PORT=MCU1, AXIS_NO=10,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis10,AXIS_NO=10,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis10,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "11")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=11)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis11")
epicsEnvSet("ECMC_R",                     "Axis11-")
epicsEnvSet("ECMC_AXIS_NO",               "11")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (11)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error2022/07/07 09:01:15.706 OK
2022/07/07 09:01:15.706 OK
2022/07/07 09:01:15.706 OK
2022/07/07 09:01:15.706 OK
2022/07/07 09:01:15.706 OK
2022/07/07 09:01:15.706 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(11,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(11,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(11, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(11, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(11,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(11,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(11,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(11,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(11,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(11,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax11.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(11,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(11,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(11,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(11,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(11,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(11,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(11,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(11,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(11,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax11.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax11.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax11.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax11.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax11.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(11,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(11,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(11,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(11,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(11,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(11,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(11,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(11,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(11,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(11,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(11,0)"
ecmcConfigOrDie "Cfg.SetAxisEnabl2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.707 OK
2022/07/07 09:01:15.708 OK
2022/07/07 09:01:15.708 OK
2022/07/07 09:01:15.708 ecmcMotorRecord:: setIntegerParam(11 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.708 ecmcMotorRecord:: setDoubleParam(11 motorPowerOnDelay_)=6
2022/07/07 09:01:15.708 ecmcMotorRecord:: setDoubleParam(11 motorPowerOffDelay_=-1
2022/07/07 09:01:15.708 ecmcMotorRecord:: connected(11)
2022/07/07 09:01:15.708 ecmcMotorRecord:: initialPoll(11) status=0
eSoftLimitBwd(11,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(11,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(11,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(11,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(11,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(11,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(11, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(11, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "11", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis11, MOTOR_PORT=MCU1, AXIS_NO=11, DESC=MCU1025 Center Position (11), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis11, MOTOR_PORT=MCU1, AXIS_NO=11,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis11,AXIS_NO=11,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis11,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "12")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=12)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis12")
epicsEnvSet("ECMC_R",                     "Axis12-")
epicsEnvSet("ECMC_AXIS_NO",               "12")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (12)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie2022/07/07 09:01:15.713 OK
2022/07/07 09:01:15.713 OK
2022/07/07 09:01:15.713 OK
2022/07/07 09:01:15.713 OK
2022/07/07 09:01:15.713 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.714 OK
2022/07/07 09:01:15.715 OK
2022/07/07 09:01:15.715 OK
2022/07/07 09:01:15.715 OK
2022/07/07 09:01:15.715 OK
2022/07/07 09:01:15.715 OK
2022/07/07 09:01:15.715 OK
2022/07/07 09:01:15.715 OK
 "Cfg.CreateAxis(12,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(12,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(12, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(12, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(12,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(12,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(12,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(12,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(12,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(12,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax12.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(12,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(12,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(12,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(12,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(12,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(12,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(12,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(12,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(12,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax12.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax12.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax12.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax12.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax12.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(12,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(12,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(12,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(12,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(12,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(12,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(12,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(12,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(12,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(12,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(12,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(12,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(12,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(12,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(12,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(12,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(12,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(12, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(12, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#============================================================2022/07/07 09:01:15.715 ecmcMotorRecord:: setIntegerParam(12 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.715 ecmcMotorRecord:: setDoubleParam(12 motorPowerOnDelay_)=6
2022/07/07 09:01:15.715 ecmcMotorRecord:: setDoubleParam(12 motorPowerOffDelay_=-1
2022/07/07 09:01:15.715 ecmcMotorRecord:: connected(12)
2022/07/07 09:01:15.715 ecmcMotorRecord:: initialPoll(12) status=0
==================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "12", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis12, MOTOR_PORT=MCU1, AXIS_NO=12, DESC=MCU1025 Center Position (12), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis12, MOTOR_PORT=MCU1, AXIS_NO=12,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis12,AXIS_NO=12,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis12,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "13")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=13)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis13")
epicsEnvSet("ECMC_R",                     "Axis13-")
epicsEnvSet("ECMC_AXIS_NO",               "13")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (13)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL"2022/07/07 09:01:15.720 OK
2022/07/07 09:01:15.720 OK
2022/07/07 09:01:15.720 OK
2022/07/07 09:01:15.720 OK
2022/07/07 09:01:15.720 OK
,     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(13,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(13,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(13, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(13, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_E2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.721 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 OK
2022/07/07 09:01:15.722 ecmcMotorRecord:: setIntegerParam(13 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.722 ecmcMotorRecord:: setDoubleParam(13 motorPowerOnDelay_)=6
2022/07/07 09:01:15.722 ecmcMotorRecord:: setDoubleParam(13 motorPowerOffDelay_=-1
2022/07/07 09:01:15.722 ecmcMotorRecord:: connected(13)
2022/07/07 09:01:15.722 ecmcMotorRecord:: initialPoll(13) status=0
XE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(13,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(13,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(13,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(13,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(13,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(13,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax13.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(13,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(13,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(13,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(13,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(13,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(13,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(13,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(13,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(13,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax13.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax13.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax13.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax13.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax13.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(13,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(13,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(13,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(13,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(13,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(13,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(13,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(13,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(13,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(13,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(13,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(13,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(13,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(13,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(13,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(13,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(13,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(13, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(13, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "13", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis13, MOTOR_PORT=MCU1, AXIS_NO=13, DESC=MCU1025 Center Position (13), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis13, MOTOR_PORT=MCU1, AXIS_NO=13,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis13,AXIS_NO=13,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis13,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "14")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=14)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis14")
epicsEnvSet("ECMC_R",                     "Axis14-")
epicsEnvSet("ECMC_AXIS_NO",               "14")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (14)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='D2022/07/07 09:01:15.727 OK
2022/07/07 09:01:15.727 OK
2022/07/07 09:01:15.727 OK
2022/07/07 09:01:15.727 OK
2022/07/07 09:01:15.727 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
AQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(14,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(14,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(14, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(14, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(14,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(14,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(14,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(14,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(14,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(14,42022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.728 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 OK
2022/07/07 09:01:15.729 ecmcMotorRecord:: setIntegerParam(14 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.729 ecmcMotorRecord:: setDoubleParam(14 motorPowerOnDelay_)=6
2022/07/07 09:01:15.729 ecmcMotorRecord:: setDoubleParam(14 motorPowerOffDelay_=-1
2022/07/07 09:01:15.729 ecmcMotorRecord:: connected(14)
2022/07/07 09:01:15.729 ecmcMotorRecord:: initialPoll(14) status=0
)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax14.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(14,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(14,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(14,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(14,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(14,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(14,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(14,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(14,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(14,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax14.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax14.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax14.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax14.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax14.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(14,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(14,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(14,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(14,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(14,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(14,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(14,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(14,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(14,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(14,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(14,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(14,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(14,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(14,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(14,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(14,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(14,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(14, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(14, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "14", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis14, MOTOR_PORT=MCU1, AXIS_NO=14, DESC=MCU1025 Center Position (14), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis14, MOTOR_PORT=MCU1, AXIS_NO=14,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis14,AXIS_NO=14,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis14,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "15")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=15)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis15")
epicsEnvSet("ECMC_R",                     "Axis15-")
epicsEnvSet("ECMC_AXIS_NO",               "15")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (15)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc2022/07/07 09:01:15.734 OK
2022/07/07 09:01:15.734 OK
2022/07/07 09:01:15.734 OK
2022/07/07 09:01:15.734 OK
2022/07/07 09:01:15.734 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(15,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(15,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax15.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(15, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(15, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(15,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(15,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(15,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(15,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(15,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(15,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax15.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(15,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(15,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(15,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(15,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(15,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(15,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(15,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(15,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(15,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax15.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax15.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax15.enc.alarm1")"
ecmcConfigOrDie "Cfg.Link2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.735 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 OK
2022/07/07 09:01:15.736 ecmcMotorRecord:: setIntegerParam(15 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.736 ecmcMotorRecord:: setDoubleParam(15 motorPowerOnDelay_)=6
2022/07/07 09:01:15.736 ecmcMotorRecord:: setDoubleParam(15 motorPowerOffDelay_=-1
2022/07/07 09:01:15.736 ecmcMotorRecord:: connected(15)
2022/07/07 09:01:15.736 ecmcMotorRecord:: initialPoll(15) status=0
EcEntryToObject(,"ax15.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax15.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax15.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax15.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax15.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax15.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax15.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax15.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax15.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(15,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(15,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(15,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(15,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(15,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(15,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(15,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(15,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(15,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(15,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(15,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(15,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(15,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(15,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(15,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(15,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(15,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(15, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(15, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "15", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis15, MOTOR_PORT=MCU1, AXIS_NO=15, DESC=MCU1025 Center Position (15), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis15, MOTOR_PORT=MCU1, AXIS_NO=15,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis15,AXIS_NO=15,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis15,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "16")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=16)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis16")
epicsEnvSet("ECMC_R",                     "Axis16-")
epicsEnvSet("ECMC_AXIS_NO",               "16")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (16)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_2022/07/07 09:01:15.741 OK
2022/07/07 09:01:15.741 OK
2022/07/07 09:01:15.741 OK
2022/07/07 09:01:15.741 OK
2022/07/07 09:01:15.741 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.742 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(16,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(16,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(16, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(16, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(16,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(16,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(16,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(16,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(16,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(16,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax16.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(16,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(16,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(16,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(16,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(16,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(16,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(16,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(16,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(16,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax16.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax16.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax16.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax16.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax16.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(16,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(16,100)"
ecmcConf2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 OK
2022/07/07 09:01:15.743 ecmcMotorRecord:: setIntegerParam(16 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.743 ecmcMotorRecord:: setDoubleParam(16 motorPowerOnDelay_)=6
2022/07/07 09:01:15.743 ecmcMotorRecord:: setDoubleParam(16 motorPowerOffDelay_=-1
2022/07/07 09:01:15.743 ecmcMotorRecord:: connected(16)
2022/07/07 09:01:15.743 ecmcMotorRecord:: initialPoll(16) status=0
igOrDie "Cfg.SetAxisMonEnableAtTargetMon(16,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(16,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(16,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(16,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(16,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(16,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(16,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(16,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(16,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(16,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(16,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(16,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(16,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(16,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(16,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(16, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(16, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "16", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis16, MOTOR_PORT=MCU1, AXIS_NO=16, DESC=MCU1025 Center Position (16), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis16, MOTOR_PORT=MCU1, AXIS_NO=16,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis16,AXIS_NO=16,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis16,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "17")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=17)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis17")
epicsEnvSet("ECMC_R",                     "Axis17-")
epicsEnvSet("ECMC_AXIS_NO",               "17")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (17)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarni2022/07/07 09:01:15.748 OK
2022/07/07 09:01:15.748 OK
2022/07/07 09:01:15.748 OK
2022/07/07 09:01:15.748 OK
2022/07/07 09:01:15.748 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.749 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
ng.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(17,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(17,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(17, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(17, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(17,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(17,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(17,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(17,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(17,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(17,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax17.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(17,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(17,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(17,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(17,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(17,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(17,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(17,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(17,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(17,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax17.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax17.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax17.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax17.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax17.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(17,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(17,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(17,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(17,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(17,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(17,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(17,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(17,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(17,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(17,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(17,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(17,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(17,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(17,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(17,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLat2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 OK
2022/07/07 09:01:15.750 ecmcMotorRecord:: setIntegerParam(17 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.750 ecmcMotorRecord:: setDoubleParam(17 motorPowerOnDelay_)=6
2022/07/07 09:01:15.750 ecmcMotorRecord:: setDoubleParam(17 motorPowerOffDelay_=-1
2022/07/07 09:01:15.750 ecmcMotorRecord:: connected(17)
2022/07/07 09:01:15.750 ecmcMotorRecord:: initialPoll(17) status=0
chCountOffset(17,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(17,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(17, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(17, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "17", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis17, MOTOR_PORT=MCU1, AXIS_NO=17, DESC=MCU1025 Center Position (17), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis17, MOTOR_PORT=MCU1, AXIS_NO=17,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis17,AXIS_NO=17,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis17,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "18")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=18)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis18")
epicsEnvSet("ECMC_R",                     "Axis18-")
epicsEnvSet("ECMC_AXIS_NO",               "18")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (18)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch i2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(1) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000014
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(1) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(1) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(2) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000006
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(2) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(2) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(3) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000003
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(3) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(3) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(4) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000007
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(4) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(4) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(5) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000003
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(5) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(5) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(6) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000002
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(6) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(6) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(7) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000004
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(7) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(7) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(8) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000005
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(8) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(8) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(9) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000002
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(9) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(9) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(10) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(10) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(10) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(11) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000003
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(11) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(11) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(12) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000004
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(12) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(12) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(13) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000002
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(13) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(13) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(14) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000002
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(14) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(14) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(15) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000005
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(15) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(15) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(16) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(16) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(16) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(17) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000002
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(17) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.755 ecmcMotorRecord:: poll(17) callParamCallbacksUpdateError Error=4 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.756 OK
2022/07/07 09:01:15.756 OK
2022/07/07 09:01:15.756 OK
2022/07/07 09:01:15.756 OK
nput
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(18,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(18,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(18, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(18,2022/07/07 09:01:15.756 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.757 OK
2022/07/07 09:01:15.758 OK
2022/07/07 09:01:15.758 OK
2022/07/07 09:01:15.758 OK
2022/07/07 09:01:15.758 OK
2022/07/07 09:01:15.758 OK
2022/07/07 09:01:15.758 ecmcMotorRecord:: setIntegerParam(18 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.758 ecmcMotorRecord:: setDoubleParam(18 motorPowerOnDelay_)=6
2022/07/07 09:01:15.758 ecmcMotorRecord:: setDoubleParam(18 motorPowerOffDelay_=-1
2022/07/07 09:01:15.758 ecmcMotorRecord:: connected(18)
2022/07/07 09:01:15.758 ecmcMotorRecord:: initialPoll(18) status=0
 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(18,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(18,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(18,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(18,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(18,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(18,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax18.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(18,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(18,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(18,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(18,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(18,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(18,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(18,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(18,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(18,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax18.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax18.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax18.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax18.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax18.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(18,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(18,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(18,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(18,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(18,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(18,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(18,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(18,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(18,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(18,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(18,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(18,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(18,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(18,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(18,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(18,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(18,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(18, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(18, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "18", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis18, MOTOR_PORT=MCU1, AXIS_NO=18, DESC=MCU1025 Center Position (18), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis18, MOTOR_PORT=MCU1, AXIS_NO=18,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis18,AXIS_NO=18,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis18,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "19")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=19)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis19")
epicsEnvSet("ECMC_R",                     "Axis19-")
epicsEnvSet("ECMC_AXIS_NO",               "19")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (19)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100"2022/07/07 09:01:15.763 OK
2022/07/07 09:01:15.763 OK
2022/07/07 09:01:15.763 OK
2022/07/07 09:01:15.763 OK
2022/07/07 09:01:15.763 OK
)
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(19,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(19,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(19, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(19, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
################################2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.764 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 OK
2022/07/07 09:01:15.765 ecmcMotorRecord:: setIntegerParam(19 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.765 ecmcMotorRecord:: setDoubleParam(19 motorPowerOnDelay_)=6
2022/07/07 09:01:15.765 ecmcMotorRecord:: setDoubleParam(19 motorPowerOffDelay_=-1
2022/07/07 09:01:15.765 ecmcMotorRecord:: connected(19)
2022/07/07 09:01:15.765 ecmcMotorRecord:: initialPoll(19) status=0
#########################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(19,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(19,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(19,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(19,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(19,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(19,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax19.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(19,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(19,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(19,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(19,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(19,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(19,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(19,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(19,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(19,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax19.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax19.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax19.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax19.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax19.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(19,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(19,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(19,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(19,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(19,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(19,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(19,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(19,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(19,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(19,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(19,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(19,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(19,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(19,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(19,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(19,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(19,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(19, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(19, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "19", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis19, MOTOR_PORT=MCU1, AXIS_NO=19, DESC=MCU1025 Center Position (19), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis19, MOTOR_PORT=MCU1, AXIS_NO=19,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis19,AXIS_NO=19,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis19,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "20")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=20)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis20")
epicsEnvSet("ECMC_R",                     "Axis20-")
epicsEnvSet("ECMC_AXIS_NO",               "20")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (20)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_2022/07/07 09:01:15.770 OK
2022/07/07 09:01:15.770 OK
2022/07/07 09:01:15.770 OK
2022/07/07 09:01:15.770 OK
2022/07/07 09:01:15.770 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(20,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(20,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(20, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(20, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(20,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(20,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(20,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(20,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(20,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(20,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax20.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(20,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(20,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(20,1)"
ecm2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.771 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 OK
2022/07/07 09:01:15.772 ecmcMotorRecord:: setIntegerParam(20 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.772 ecmcMotorRecord:: setDoubleParam(20 motorPowerOnDelay_)=6
2022/07/07 09:01:15.772 ecmcMotorRecord:: setDoubleParam(20 motorPowerOffDelay_=-1
2022/07/07 09:01:15.772 ecmcMotorRecord:: connected(20)
2022/07/07 09:01:15.772 ecmcMotorRecord:: initialPoll(20) status=0
cConfigOrDie "Cfg.SetAxisEncBits(20,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(20,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(20,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(20,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(20,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(20,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax20.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax20.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax20.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax20.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax20.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(20,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(20,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(20,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(20,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(20,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(20,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(20,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(20,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(20,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(20,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(20,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(20,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(20,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(20,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(20,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(20,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(20,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(20, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(20, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "20", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis20, MOTOR_PORT=MCU1, AXIS_NO=20, DESC=MCU1025 Center Position (20), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis20, MOTOR_PORT=MCU1, AXIS_NO=20,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis20,AXIS_NO=20,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis20,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "21")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=21)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis21")
epicsEnvSet("ECMC_R",                     "Axis21-")
epicsEnvSet("ECMC_AXIS_NO",               "21")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (21)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/2022/07/07 09:01:15.777 OK
2022/07/07 09:01:15.777 OK
2022/07/07 09:01:15.777 OK
2022/07/07 09:01:15.777 OK
2022/07/07 09:01:15.777 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(21,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(21,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(21, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(21, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(21,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(21,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(21,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(21,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(21,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(21,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax21.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(21,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(21,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(21,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(21,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(21,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(21,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(21,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(21,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(21,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.enc.la2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.778 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 OK
2022/07/07 09:01:15.779 ecmcMotorRecord:: setIntegerParam(21 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.779 ecmcMotorRecord:: setDoubleParam(21 motorPowerOnDelay_)=6
2022/07/07 09:01:15.779 ecmcMotorRecord:: setDoubleParam(21 motorPowerOffDelay_=-1
2022/07/07 09:01:15.779 ecmcMotorRecord:: connected(21)
2022/07/07 09:01:15.779 ecmcMotorRecord:: initialPoll(21) status=0
tchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax21.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax21.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax21.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax21.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax21.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(21,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(21,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(21,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(21,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(21,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(21,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(21,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(21,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(21,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(21,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(21,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(21,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(21,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(21,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(21,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(21,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(21,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(21, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(21, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "21", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis21, MOTOR_PORT=MCU1, AXIS_NO=21, DESC=MCU1025 Center Position (21), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis21, MOTOR_PORT=MCU1, AXIS_NO=21,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis21,AXIS_NO=21,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis21,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "22")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=22)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis22")
epicsEnvSet("ECMC_R",                     "Axis22-")
epicsEnvSet("ECMC_AXIS_NO",               "22")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (22)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_E2022/07/07 09:01:15.784 OK
2022/07/07 09:01:15.784 OK
2022/07/07 09:01:15.784 OK
2022/07/07 09:01:15.784 OK
2022/07/07 09:01:15.784 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.785 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
NC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(22,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(22,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(22, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(22, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(22,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(22,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(22,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(22,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(22,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(22,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax22.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(22,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(22,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(22,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(22,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(22,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(22,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(22,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(22,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(22,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax22.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax22.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax22.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax22.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax22.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(22,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(22,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(22,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(22,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(22,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(22,0)"
ecmcConfigOrDie "C2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 OK
2022/07/07 09:01:15.786 ecmcMotorRecord:: setIntegerParam(22 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.786 ecmcMotorRecord:: setDoubleParam(22 motorPowerOnDelay_)=6
2022/07/07 09:01:15.786 ecmcMotorRecord:: setDoubleParam(22 motorPowerOffDelay_=-1
2022/07/07 09:01:15.786 ecmcMotorRecord:: connected(22)
2022/07/07 09:01:15.786 ecmcMotorRecord:: initialPoll(22) status=0
fg.SetAxisMonMaxVel(22,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(22,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(22,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(22,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(22,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(22,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(22,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(22,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(22,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(22,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(22,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(22, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(22, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "22", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis22, MOTOR_PORT=MCU1, AXIS_NO=22, DESC=MCU1025 Center Position (22), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis22, MOTOR_PORT=MCU1, AXIS_NO=22,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis22,AXIS_NO=22,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis22,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "23")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=23)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis23")
epicsEnvSet("ECMC_R",                     "Axis23-")
epicsEnvSet("ECMC_AXIS_NO",               "23")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (23)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be u2022/07/07 09:01:15.791 OK
2022/07/07 09:01:15.791 OK
2022/07/07 09:01:15.791 OK
2022/07/07 09:01:15.791 OK
2022/07/07 09:01:15.791 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.792 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
2022/07/07 09:01:15.793 OK
sed. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(23,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(23,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(23, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(23, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(23,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(23,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(23,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(23,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(23,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(23,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax23.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(23,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(23,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(23,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(23,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(23,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(23,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(23,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(23,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(23,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax23.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax23.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax23.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax23.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax23.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(23,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(23,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(23,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(23,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(23,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(23,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(23,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(23,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(23,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(23,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(23,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(23,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(23,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(23,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(23,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(23,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(23,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(23, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(23, 0)"
 ecmcFileExist("/home/ander2022/07/07 09:01:15.793 ecmcMotorRecord:: setIntegerParam(23 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.793 ecmcMotorRecord:: setDoubleParam(23 motorPowerOnDelay_)=6
2022/07/07 09:01:15.793 ecmcMotorRecord:: setDoubleParam(23 motorPowerOffDelay_=-1
2022/07/07 09:01:15.793 ecmcMotorRecord:: connected(23)
2022/07/07 09:01:15.793 ecmcMotorRecord:: initialPoll(23) status=0
ssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "23", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis23, MOTOR_PORT=MCU1, AXIS_NO=23, DESC=MCU1025 Center Position (23), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis23, MOTOR_PORT=MCU1, AXIS_NO=23,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis23,AXIS_NO=23,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis23,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "24")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=24)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis24")
epicsEnvSet("ECMC_R",                     "Axis24-")
epicsEnvSet("ECMC_AXIS_NO",               "24")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (24)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_S2022/07/07 09:01:15.798 OK
2022/07/07 09:01:15.798 OK
2022/07/07 09:01:15.798 OK
2022/07/07 09:01:15.798 OK
2022/07/07 09:01:15.798 OK
OFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(24,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(24,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(24, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(24, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.799 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 OK
2022/07/07 09:01:15.800 ecmcMotorRecord:: setIntegerParam(24 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.800 ecmcMotorRecord:: setDoubleParam(24 motorPowerOnDelay_)=6
2022/07/07 09:01:15.800 ecmcMotorRecord:: setDoubleParam(24 motorPowerOffDelay_=-1
2022/07/07 09:01:15.800 ecmcMotorRecord:: connected(24)
2022/07/07 09:01:15.800 ecmcMotorRecord:: initialPoll(24) status=0
0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(24,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(24,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(24,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(24,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(24,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(24,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax24.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(24,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(24,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(24,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(24,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(24,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(24,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(24,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(24,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(24,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax24.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax24.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax24.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax24.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax24.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(24,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(24,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(24,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(24,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(24,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(24,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(24,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(24,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(24,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(24,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(24,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(24,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(24,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(24,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(24,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(24,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(24,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(24, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(24, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "24", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis24, MOTOR_PORT=MCU1, AXIS_NO=24, DESC=MCU1025 Center Position (24), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis24, MOTOR_PORT=MCU1, AXIS_NO=24,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis24,AXIS_NO=24,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis24,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "25")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=25)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis25")
epicsEnvSet("ECMC_R",                     "Axis25-")
epicsEnvSet("ECMC_AXIS_NO",               "25")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (25)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxi2022/07/07 09:01:15.805 OK
2022/07/07 09:01:15.805 OK
2022/07/07 09:01:15.805 OK
2022/07/07 09:01:15.805 OK
2022/07/07 09:01:15.805 OK
s.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(25,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(25,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(25, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(25, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcCon2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.806 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 OK
2022/07/07 09:01:15.807 ecmcMotorRecord:: setIntegerParam(25 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.807 ecmcMotorRecord:: setDoubleParam(25 motorPowerOnDelay_)=6
2022/07/07 09:01:15.807 ecmcMotorRecord:: setDoubleParam(25 motorPowerOffDelay_=-1
2022/07/07 09:01:15.807 ecmcMotorRecord:: connected(25)
2022/07/07 09:01:15.807 ecmcMotorRecord:: initialPoll(25) status=0
figOrDie "Cfg.SetAxisVelAccDecTime(25,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(25,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(25,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(25,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(25,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(25,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax25.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(25,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(25,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(25,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(25,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(25,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(25,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(25,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(25,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(25,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax25.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax25.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax25.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax25.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax25.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(25,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(25,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(25,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(25,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(25,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(25,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(25,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(25,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(25,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(25,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(25,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(25,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(25,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(25,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(25,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(25,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(25,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(25, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(25, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "25", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis25, MOTOR_PORT=MCU1, AXIS_NO=25, DESC=MCU1025 Center Position (25), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis25, MOTOR_PORT=MCU1, AXIS_NO=25,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis25,AXIS_NO=25,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis25,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "26")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=26)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis26")
epicsEnvSet("ECMC_R",                     "Axis26-")
epicsEnvSet("ECMC_AXIS_NO",               "26")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (26)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================2022/07/07 09:01:15.812 OK
2022/07/07 09:01:15.813 OK
2022/07/07 09:01:15.813 OK
2022/07/07 09:01:15.813 OK
2022/07/07 09:01:15.813 OK
2022/07/07 09:01:15.813 OK
2022/07/07 09:01:15.813 OK
2022/07/07 09:01:15.813 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(26,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(26,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(26, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(26, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(26,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(26,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(26,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(26,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(26,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(26,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax26.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(26,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(26,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(26,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(26,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(26,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(26,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(26,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPo2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.814 OK
2022/07/07 09:01:15.815 ecmcMotorRecord:: setIntegerParam(26 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.815 ecmcMotorRecord:: setDoubleParam(26 motorPowerOnDelay_)=6
2022/07/07 09:01:15.815 ecmcMotorRecord:: setDoubleParam(26 motorPowerOffDelay_=-1
2022/07/07 09:01:15.815 ecmcMotorRecord:: connected(26)
2022/07/07 09:01:15.815 ecmcMotorRecord:: initialPoll(26) status=0
sFilterSize(26,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(26,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax26.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax26.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax26.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax26.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax26.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(26,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(26,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(26,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(26,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(26,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(26,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(26,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(26,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(26,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(26,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(26,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(26,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(26,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(26,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(26,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(26,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(26,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(26, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(26, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "26", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis26, MOTOR_PORT=MCU1, AXIS_NO=26, DESC=MCU1025 Center Position (26), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis26, MOTOR_PORT=MCU1, AXIS_NO=26,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis26,AXIS_NO=26,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis26,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "27")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=27)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis27")
epicsEnvSet("ECMC_R",                     "Axis27-")
epicsEnvSet("ECMC_AXIS_NO",               "27")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (27)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',E2022/07/07 09:01:15.820 OK
2022/07/07 09:01:15.820 OK
2022/07/07 09:01:15.820 OK
2022/07/07 09:01:15.820 OK
2022/07/07 09:01:15.820 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
RROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(27,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(27,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(27, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(27, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(27,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(27,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(27,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(27,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(27,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(27,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax27.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(27,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(27,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(27,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(27,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(27,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(27,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(27,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(27,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(27,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax27.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax27.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax27.mon2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.821 OK
2022/07/07 09:01:15.822 OK
2022/07/07 09:01:15.822 OK
2022/07/07 09:01:15.822 OK
2022/07/07 09:01:15.822 OK
2022/07/07 09:01:15.822 OK
2022/07/07 09:01:15.822 ecmcMotorRecord:: setIntegerParam(27 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.822 ecmcMotorRecord:: setDoubleParam(27 motorPowerOnDelay_)=6
2022/07/07 09:01:15.822 ecmcMotorRecord:: setDoubleParam(27 motorPowerOffDelay_=-1
2022/07/07 09:01:15.822 ecmcMotorRecord:: connected(27)
2022/07/07 09:01:15.822 ecmcMotorRecord:: initialPoll(27) status=0
.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax27.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax27.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(27,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(27,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(27,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(27,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(27,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(27,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(27,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(27,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(27,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(27,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(27,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(27,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(27,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(27,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(27,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(27,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(27,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(27, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(27, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "27", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis27, MOTOR_PORT=MCU1, AXIS_NO=27, DESC=MCU1025 Center Position (27), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis27, MOTOR_PORT=MCU1, AXIS_NO=27,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis27,AXIS_NO=27,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis27,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "28")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=28)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis28")
epicsEnvSet("ECMC_R",                     "Axis28-")
epicsEnvSet("ECMC_AXIS_NO",               "28")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (28)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(2022/07/07 09:01:15.827 OK
2022/07/07 09:01:15.827 OK
2022/07/07 09:01:15.827 OK
2022/07/07 09:01:15.827 OK
2022/07/07 09:01:15.827 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
2022/07/07 09:01:15.828 OK
1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(28,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(28,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(28, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(28, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(28,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(28,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(28,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(28,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(28,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(28,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax28.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(28,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(28,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(28,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(28,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(28,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(28,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(28,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(28,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(28,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax28.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax28.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax28.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax28.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax28.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(28,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(28,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(28,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(28,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(28,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(28,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(28,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(28,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(28,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(28,100)"
ecmcConfigOrDie "Cf2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 OK
2022/07/07 09:01:15.829 ecmcMotorRecord:: setIntegerParam(28 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.829 ecmcMotorRecord:: setDoubleParam(28 motorPowerOnDelay_)=6
2022/07/07 09:01:15.829 ecmcMotorRecord:: setDoubleParam(28 motorPowerOffDelay_=-1
2022/07/07 09:01:15.829 ecmcMotorRecord:: connected(28)
2022/07/07 09:01:15.829 ecmcMotorRecord:: initialPoll(28) status=0
g.SetAxisSoftLimitPosBwd(28,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(28,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(28,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(28,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(28,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(28,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(28,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(28, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(28, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "28", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis28, MOTOR_PORT=MCU1, AXIS_NO=28, DESC=MCU1025 Center Position (28), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis28, MOTOR_PORT=MCU1, AXIS_NO=28,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis28,AXIS_NO=28,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis28,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "29")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=29)
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis29")
epicsEnvSet("ECMC_R",                     "Axis29-")
epicsEnvSet("ECMC_AXIS_NO",               "29")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (29)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE2022/07/07 09:01:15.834 OK
2022/07/07 09:01:15.834 OK
2022/07/07 09:01:15.834 OK
2022/07/07 09:01:15.834 OK
2022/07/07 09:01:15.834 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.835 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
2022/07/07 09:01:15.836 OK
_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(29,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(29,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(29, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(29, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(29,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(29,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(29,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(29,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(29,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(29,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax29.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(29,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(29,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(29,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(29,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(29,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(29,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(29,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(29,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(29,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax29.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax29.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax29.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax29.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax29.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(29,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(29,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(29,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(29,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(29,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(29,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(29,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(29,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(29,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(29,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(29,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(29,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(29,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(29,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(29,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(29,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(29,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(29, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(29, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.2022/07/07 09:01:15.836 ecmcMotorRecord:: setIntegerParam(29 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.836 ecmcMotorRecord:: setDoubleParam(29 motorPowerOnDelay_)=6
2022/07/07 09:01:15.836 ecmcMotorRecord:: setDoubleParam(29 motorPowerOffDelay_=-1
2022/07/07 09:01:15.836 ecmcMotorRecord:: connected(29)
2022/07/07 09:01:15.836 ecmcMotorRecord:: initialPoll(29) status=0
cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "29", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis29, MOTOR_PORT=MCU1, AXIS_NO=29, DESC=MCU1025 Center Position (29), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.template,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis29, MOTOR_PORT=MCU1, AXIS_NO=29,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis29,AXIS_NO=29,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis29,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
epicsEnvSet("ID",       "30")
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/configureVirtualAxis.cmd, CONFIG=./cfg/linear.vax, ID=30
#==============================================================================
# configureVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
iocshLoad ./cfg/linear.vax
#General
epicsEnvSet("ECMC_MOTOR_NAME",            "Axis30")
epicsEnvSet("ECMC_R",                     "Axis30-")
epicsEnvSet("ECMC_AXIS_NO",               "30")
epicsEnvSet("ECMC_DESC",                  "MCU1025 Center Position (30)")
epicsEnvSet("ECMC_EGU",                   "mm")                       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "3")                        # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "")                         # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "")                         # Entry for axis health output (example: ec0.s1.binaryOutput01.0)
epicsEnvSet("ECMC_MOD_RANGE" ,            "0")                        # Modulo range (traj setpoints and encoder values will be in range 0..ECMC_MOD_RANGE)
epicsEnvSet("ECMC_MOD_TYPE",              "0")                        # For positioning and MOD_RANGE>0: 0 = Normal, 1 = Always Fwd, 2 = Always Bwd, 3 = Closest Distance
#Encoder
epicsEnvSet("ECMC_ENC_SCALE_NUM"          "1")
epicsEnvSet("ECMC_ENC_SCALE_DENOM"        "1")
epicsEnvSet("ECMC_ENC_TYPE"               "1")                        # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_ENC_BITS"               "0")                        # Total bit count of encoder raw data
epicsEnvSet("ECMC_ENC_ABS_BITS",          "0")                        # Absolute bit count (for absolute encoders) always least significant part of ECMC_ENC_BITS
epicsEnvSet("ECMC_ENC_ABS_OFFSET"         "0")                        # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "ec0.s2.ZERO")              # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_EC_ENC_RESET",          "")                         # Reset   (if no encoder reset bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_0",        "")                         # Error 0 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_1",        "")                         # Error 1 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_ALARM_2",        "")                         # Error 2 (if no encoder error bit then leave empty)
epicsEnvSet("ECMC_EC_ENC_WARNING",        "")                         # Warning (if no encoder warning bit then leave empty)
#Trajectory
epicsEnvSet("ECMC_VELO",                  "5.0")
epicsEnvSet("ECMC_JOG_VEL",               "5")
epicsEnvSet("ECMC_JAR",                   "0.0")                      # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "0.1")
epicsEnvSet("ECMC_EMERG_DECEL",           "0.1")             # Emergency deceleration
#Homing
epicsEnvSet("ECMC_HOME_PROC",             "3")
epicsEnvSet("ECMC_HOME_POS",              "0.0")
epicsEnvSet("ECMC_HOME_VEL_TO",           "5")
epicsEnvSet("ECMC_HOME_VEL_FRM",          "4")
epicsEnvSet("ECMC_HOME_ACC",              "21")
epicsEnvSet("ECMC_HOME_DEC",              "100")
epicsEnvSet("ECMC_HOME_POS_MOVE_ENA",     "0")                        # Enable move to position after successfull homing 
epicsEnvSet("ECMC_HOME_POS_MOVE_TARG_POS","0")                        # Target position to go to after successfull homing
#Monitoring
# Switches
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "ec0.s2.ONE.0")           #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "ec0.s2.ONE.0")           #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "ec0.s2.ONE.0")           #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "ec0.s2.ONE.0")           #  Ethercat entry for external interlock input
# Softlimits (disable with 0,0)
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "0")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "0")
epicsEnvSet("ECMC_DXLM_ENABLE",           "1")
# Position lag
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "0.5")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "100")
epicsEnvSet("ECMC_MON_LAG_MON_E2022/07/07 09:01:15.841 OK
2022/07/07 09:01:15.841 OK
2022/07/07 09:01:15.841 OK
2022/07/07 09:01:15.841 OK
2022/07/07 09:01:15.841 OK
NA",       "0")
# At target
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "0.3")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "100")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "1")
# Velocity
epicsEnvSet("ECMC_MON_VELO_MAX",          "200.0")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","100")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "200")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "1")
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/addVirtualAxis.cmd
#==============================================================================
# addVirtualAxis.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD, "'FULL'='DAQ'","ecmcExit Error: ECMC started in DAQ mode. Motion not supported..","#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis-records.cmd
#==============================================================================
# ecmc_virt_axis-records.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd",1)
iocshLoad( /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis.cmd )
#==============================================================================
# ecmc_virt_axis.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_NUM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_NUM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_NUM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_NUM == 0...")
# ECMC_ENC_SCALE_NUM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/verifyOrDie.cmd "EXPR_STR='abs(1)<>0',SUCCESS_STR='ECMC_ENC_SCALE_DENOM value OK == 1...',ERROR_STR='ECMC_ENC_SCALE_DENOM == 0...'"
#==============================================================================
# verifyOrDie.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"abs(1)<>0","# ECMC_ENC_SCALE_DENOM value OK == 1...", "ecmcExit Error: ECMC_ENC_SCALE_DENOM == 0...")
# ECMC_ENC_SCALE_DENOM value OK == 1...
epicsEnvUnset(ECMC_EXE_CMD)
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='-1>0',WARNING_STR='WARNING: ECMC_MRES setting is deprecated and will not be used. (MRES will be calulated instead: ECMC_ENC_SCALE_NUM/ECMC_ENC_SCALE_DENOM).. '"
#==============================================================================
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"-1>0","", "#-")
epicsEnvUnset(ECMC_EXE_CMD)
ecmcConfigOrDie "Cfg.CreateAxis(30,2,0,0)"
ecmcConfigOrDie "Cfg.SetAxisTrajStartPos(30,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.health")"
ecmcConfigOrDie "Cfg.SetAxisModRange(30, 0)"
ecmcConfigOrDie "Cfg.SetAxisModType(30, 0)"
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/issueWarning.cmd "EXPR_STR='0.1>0',WARNING_STR='WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..'"
#===================================================================2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.842 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 OK
2022/07/07 09:01:15.843 ecmcMotorRecord:: setIntegerParam(30 motorPowerAutoOnOff_)=2
2022/07/07 09:01:15.843 ecmcMotorRecord:: setDoubleParam(30 motorPowerOnDelay_)=6
2022/07/07 09:01:15.843 ecmcMotorRecord:: setDoubleParam(30 motorPowerOffDelay_=-1
2022/07/07 09:01:15.843 ecmcMotorRecord:: connected(30)
2022/07/07 09:01:15.843 ecmcMotorRecord:: initialPoll(30) status=0
===========
# issueWarning.cmd
ecmcEpicsEnvSetCalcTernary(ECMC_EXE_CMD,"0.1>0","", "#-")
############## WARNING ##################################################
 # WARNING: ECMC_ACCL setting is deprecated. Please use ECMC_ACCS_EGU_PER_S2 instead..
#########################################################################
epicsEnvUnset(ECMC_EXE_CMD)
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCL,"'0.1'!='EMPTY'","", "#-")
ecmcEpicsEnvSetCalcTernary(ECMC_BLOCK_ACCS,"'0.1'=='EMPTY'","", "#-")
 ecmcConfigOrDie "Cfg.SetAxisVelAccDecTime(30,5.0,0.1)"
ecmcConfigOrDie "Cfg.SetAxisJerk(30,0)"
ecmcConfigOrDie "Cfg.SetAxisVel(30,5.0)"
ecmcConfigOrDie "Cfg.SetAxisEmergDeceleration(30,0.1)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelTowardsCam(30,5)"
ecmcConfigOrDie "Cfg.SetAxisHomeVelOffCam(30,4)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ZERO,"ax30.enc.actpos")"
ecmcConfigOrDie "Cfg.SetAxisEncScaleDenom(30,1)"
ecmcConfigOrDie "Cfg.SetAxisEncScaleNum(30,1)"
ecmcConfigOrDie "Cfg.SetAxisEncType(30,1)"
ecmcConfigOrDie "Cfg.SetAxisEncBits(30,0)"
ecmcConfigOrDie "Cfg.SetAxisEncAbsBits(30,0)"
ecmcConfigOrDie "Cfg.SetAxisEncOffset(30,0)"
ecmcConfigOrDie "Cfg.SetAxisEncVelFilterSize(30,100)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterSize(30,1)"
ecmcConfigOrDie "Cfg.SetAxisEncPosFilterEnable(30,0)"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.enc.reset")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.enc.alarm0")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.enc.alarm1")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.enc.alarm2")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.enc.warning")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.enc.latchpos")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.enc.latchcontrol")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(,"ax30.enc.latchstatus")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax30.mon.lowlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax30.mon.highlim")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax30.mon.homesensor")"
ecmcConfigOrDie "Cfg.LinkEcEntryToObject(ec0.s2.ONE.0,"ax30.mon.extinterlock")"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTol(30,0.3)"
ecmcConfigOrDie "Cfg.SetAxisMonAtTargetTime(30,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableAtTargetMon(30,1)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTol(30,0.5)"
ecmcConfigOrDie "Cfg.SetAxisMonPosLagTime(30,100)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableLagMon(30,0)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVel(30,200.0)"
ecmcConfigOrDie "Cfg.SetAxisMonEnableMaxVel(30,1)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelDriveILDelay(30,200)"
ecmcConfigOrDie "Cfg.SetAxisMonMaxVelTrajILDelay(30,100)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosBwd(30,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitBwd(30,1)"
ecmcConfigOrDie "Cfg.SetAxisSoftLimitPosFwd(30,0)"
ecmcConfigOrDie "Cfg.SetAxisEnableSoftLimitFwd(30,1)"
ecmcConfigOrDie "Cfg.SetAxisMonHomeSwitchPolarity(30,0)"
ecmcConfigOrDie "Cfg.SetAxisHomeLatchCountOffset(30,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePosition(30,0.0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveEnable(30, 0)"
ecmcConfigOrDie "Cfg.SetAxisHomePostMoveTargetPosition(30, 0)"
 ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd",1)
 iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_axis_mr.cmd
#==============================================================================
# ecmc_axis_mr.cmd
ecmcMotorRecordCreateAxis(MCU1, "30", "6", )
ecmcEpicsEnvSetCalc("ECMC_TEMP_SREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%d")
ecmcEpicsEnvSetCalc("ECMC_TEMP_UREV","if(abs(1)>0){RESULT:=abs(1);} else {RESULT:=1.0};","%lf")
ecmcFileExist(ecmcMotorRecord.template,1,1)
 dbLoadRecords(ecmcMotorRecord.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis30, MOTOR_PORT=MCU1, AXIS_NO=30, DESC=MCU1025 Center Position (30), EGU=mm, PREC=3, VELO=5.0, JVEL=5, JAR=0.0, ACCL=0.1, RDBD=0.3, DLLM=0, DHLM=0, HOMEPROC=3,SREV=1,UREV=1.000000, ")
epicsEnvSet("ECMC_AXISFIELDINIT",  "")
ecmcFileExist(ecmcMotorRecordhome.templa2022/07/07 09:01:15.846 OK
2022/07/07 09:01:15.846 OK
2022/07/07 09:01:15.846 OK
te,1,1)
dbLoadRecords(ecmcMotorRecordhome.template, "PREFIX=IOC_MTCA:, MOTOR_NAME=Axis30, MOTOR_PORT=MCU1, AXIS_NO=30,HOMEPROC=3, HOMEPOS=0.0, HVELTO=5, HVELFRM=4, HOMEACC=21, HOMEDEC=100")
epicsEnvUnset(ECMC_TEMP_SREV)
epicsEnvUnset(ECMC_TEMP_UREV)
epicsEnvUnset(ECMC_BLOCK_ACCL)
epicsEnvUnset(ECMC_BLOCK_ACCS)
ecmcFileExist("ecmcAxis.db",1,1)
dbLoadRecords("ecmcAxis.db","P=IOC_MTCA:,AXIS_NAME=Axis30,AXIS_NO=30,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
ecmcFileExist("ecmcAxisType.db",1,1)
dbLoadRecords("ecmcAxisType.db","P=IOC_MTCA:,AXIS_NAME=Axis30,AXIS_TYPE=2")
ecmcFileExist(/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd,1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/ecmc_virt_axis_unset.cmd
#==============================================================================
# ecmc_virt_axis_unset.cmd
epicsEnvUnset(ECMC_AXISCONFIG)
epicsEnvUnset(ECMC_AXISFIELDINIT)
epicsEnvUnset(ECMC_PREC)
epicsEnvUnset(ECMC_EGU)
epicsEnvUnset(ECMC_DESC)
epicsEnvUnset(ECMC_R)
epicsEnvUnset(ECMC_MOTOR_NAME)
epicsEnvUnset(ECMC_EC_AXIS_HEALTH)
epicsEnvUnset(ECMC_MOD_RANGE)
epicsEnvUnset(ECMC_MOD_TYPE)
epicsEnvUnset(ECMC_EMERG_DECEL)
epicsEnvUnset(ECMC_ACCL)
epicsEnvUnset(ECMC_ACCS_EGU_PER_S2)
epicsEnvUnset(ECMC_HOME_VEL_TO)
epicsEnvUnset(ECMC_HOME_VEL_FRM)
epicsEnvUnset(ECMC_EC_ENC_ACTPOS)
epicsEnvUnset(ECMC_ENC_SCALE_DENOM)
epicsEnvUnset(ECMC_ENC_SCALE_NUM)
epicsEnvUnset(ECMC_ENC_TYPE)
epicsEnvUnset(ECMC_ENC_BITS)
epicsEnvUnset(ECMC_ENC_ABS_BITS)
epicsEnvUnset(ECMC_ENC_ABS_OFFSET)
epicsEnvUnset(ECMC_ENC_VEL_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_SIZE)
epicsEnvUnset(ECMC_ENC_POS_FILTER_ENABLE)
epicsEnvUnset(ECMC_EC_ENC_RESET)
epicsEnvUnset(ECMC_EC_ENC_ALARM_0)
epicsEnvUnset(ECMC_EC_ENC_ALARM_1)
epicsEnvUnset(ECMC_EC_ENC_ALARM_2)
epicsEnvUnset(ECMC_EC_ENC_WARNING)
epicsEnvUnset(ECMC_EC_MON_LOWLIM)
epicsEnvUnset(ECMC_EC_MON_HIGHLIM)
epicsEnvUnset(ECMC_EC_MON_HOME_SWITCH)
epicsEnvUnset(ECMC_EC_MON_EXT_INTERLOCK)
epicsEnvUnset(ECMC_MON_AT_TARGET_TOL)
epicsEnvUnset(ECMC_MON_AT_TARGET_TIME)
epicsEnvUnset(ECMC_MON_AT_TARGET_ENA)
epicsEnvUnset(ECMC_MON_LAG_MON_TOL)
epicsEnvUnset(ECMC_MON_LAG_MON_TIME)
epicsEnvUnset(ECMC_MON_LAG_MON_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX)
epicsEnvUnset(ECMC_MON_VELO_MAX_ENA)
epicsEnvUnset(ECMC_MON_VELO_MAX_DRV_TIME)
epicsEnvUnset(ECMC_MON_VELO_MAX_TRAJ_TIME)
epicsEnvUnset(ECMC_MRES)
epicsEnvUnset(ECMC_JOG_VEL)
epicsEnvUnset(ECMC_JAR)
epicsEnvUnset(ECMC_HOME_PROC)
epicsEnvUnset(ECMC_HOME_POS)
epicsEnvUnset(ECMC_HOME_ACC)
epicsEnvUnset(ECMC_HOME_DEC)
epicsEnvUnset(ECMC_DRV_TYPE)
epicsEnvUnset(ECMC_VELO)
epicsEnvUnset(ECMC_SOFT_LOW_LIM)
epicsEnvUnset(ECMC_SOFT_HIGH_LIM)
epicsEnvUnset(ECMC_HOME_POS_MOVE_ENA)
epicsEnvUnset(ECMC_HOME_POS_MOVE_TARG_POS)
epicsEnvUnset(ECMC_TRAJ_TYPE)
epicsEnvUnset(ECMC_JERK)
# reset PREFIX
epicsEnvSet("ECMC_PREFIX"      "IOC_MTCA:")
##############################################################################
## Configure diagnostics:
ecmcConfigOrDie "Cfg.EcSetDiagnostics(1)"
ecmcConfigOrDie "Cfg.EcEnablePrintouts(0)"
ecmcConfigOrDie "Cfg.EcSetDomainFailedCyclesLimit(100)"
##############################################################################
## go active
iocshLoad (/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/setAppMode.cmd)
#==============================================================================
# setAppMode.cmd
ecmcFileExist("/home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/general.cmd",1)
iocshLoad /home/anderssandstrom/sources/e3-ecmccfg/cellMods/base-7.0.6.1/require-4.0.0/ecmccfg/ruckig/general.cmd
#==============================================================================
# general.cmd
ecmcFileExist("ecmcGeneral.db",1,1)
dbLoadRecords("ecmcGeneral.db","P=IOC_MTCA:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2,ECMC_PROC_HOOK=")
# Examples of commands for info:
# ecmcReport <level> or asynReport <level>
# ecmcReport 3
# ecmcGrepParam <pat2022/07/07 09:01:15.858 INFO: Locking memory
2022/07/07 09:01:15.869 Starting up EtherCAT bus: 0 second(s). Max wait time 30 second(s).
2022/07/07 09:01:15.954 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:374: ERROR: Slave 2: Not operational (0x24011).
2022/07/07 09:01:15.954 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:379: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2022/07/07 09:01:15.954 ecmc::  Ax     PosSet     PosAct     PosErr    PosTarg   DistLeft    CntrOut   VelFFSet     VelAct   VelFFRaw VelRaw  Error Co CD St IL LI TS ES En Ex Bu Ta Hd L- L+ Ho
2022/07/07 09:01:15.954 ecmc::  30      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0      0  0  0  0 16  0  0  0 00  0  0  0  1  1  1  1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(1) homed=1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(1) LLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(1) HLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(1) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000023
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(1) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(2) homed=1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(2) LLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(2) HLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(2) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000013
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(2) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(3) homed=1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(3) LLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(3) HLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(3) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000013
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(3) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(4) homed=1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(4) LLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(4) HLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(4) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(4) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(5) homed=1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(5) LLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(5) HLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(5) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(5) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(6) homed=1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(6) LLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(6) HLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(6) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(6) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(7) homed=1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(7) LLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(7) HLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(7) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(7) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(8) homed=1
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(8) LLS=0
2022/07/07 09:01:15.955 ecmcMotorRecord:: poll(8) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(8) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(8) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(9) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(9) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(9) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(9) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(9) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(10) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(10) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(10) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(10) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000027
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(10) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(11) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(11) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(11) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(11) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(11) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(12) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(12) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(12) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(12) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(12) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(13) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(13) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(13) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(13) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(13) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(14) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(14) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(14) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(14) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(14) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(15) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(15) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(15) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(15) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(15) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(16) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(16) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(16) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(16) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(16) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(17) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(17) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(17) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(17) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(17) callParamCallbacksUpdateError Error=0 old=4 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(18) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(18) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(18) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(18) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(18) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(18) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(19) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(19) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(19) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(19) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(19) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(19) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(20) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(20) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(20) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(20) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(20) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(20) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(21) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(21) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(21) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(21) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(21) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(21) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(22) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(22) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(22) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(22) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(22) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(22) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(23) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(23) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(23) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(23) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000015
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(23) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(23) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(24) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(24) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(24) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(24) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(24) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(24) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(25) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(25) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(25) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(25) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(25) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(25) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(26) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(26) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(26) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(26) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(26) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(26) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(27) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(27) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(27) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(27) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(27) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(27) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(28) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(28) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(28) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(28) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(28) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(28) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(29) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(29) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(29) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(29) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000012
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(29) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(29) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(30) homed=1
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(30) LLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(30) HLS=0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(30) mvnNRdy=1 bBusy=0 bExecute=0 bEnabled=0 atTarget=0 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000011
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(30) bError=0 drvlocal.statusBinData.onChangeData.error=0x0
2022/07/07 09:01:15.956 ecmcMotorRecord:: poll(30) callParamCallbacksUpdateError Error=0 old=-1 ErrID=0x0 old=0x0 Warn=0 nCmd=0 old=0 txt=NULL
2022/07/07 09:01:16.055 ecmc::  30      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0      0  0  0  0 16 16  0  0 00  0  0  0  1  1  1  1
2022/07/07 09:01:16.056 ../devEcmcSup/main/ecmcError.cpp/errorReset:103: NO_ERROR (0x0).
2022/07/07 09:01:16.156 ecmc::  30      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0      0  0  0  0  0 16  0  0 00  0  0  1  1  1  1  1
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(1) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000003
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(2) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(3) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(4) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(5) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(6) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(7) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(8) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(9) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(10) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(11) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000002
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(12) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(13) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(14) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(15) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(16) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(17) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(18) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(19) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(20) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(21) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(22) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(23) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(24) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(25) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(26) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(27) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(28) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(29) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:16.156 ecmcMotorRecord:: poll(30) mvnNRdy=0 bBusy=0 bExecute=0 bEnabled=0 atTarget=1 wf=0 ENC=0 fPos=0 fActPosition=0 time=0.000001
2022/07/07 09:01:17.869 EtherCAT bus started!
2022/07/07 09:01:17.869 OK
2022/07/07 09:01:17.869 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtIocBuild (0). Allow callbacks: true.
Starting iocInit
2022/07/07 09:01:17.869 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtBeginning (1). Allow callbacks: true.
2022/07/07 09:01:17.871 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCallbackInit (2). Allow callbacks: true.
2022/07/07 09:01:17.872 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCaLinkInit (3). Allow callbacks: true.
2022/07/07 09:01:17.872 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDrvSup (4). Allow callbacks: true.
2022/07/07 09:01:17.872 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitRecSup (5). Allow callbacks: true.
2022/07/07 09:01:17.873 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDevSup (6). Allow callbacks: true.
2022/07/07 09:01:17.879 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.reset linked to record (asyn reason 1).
2022/07/07 09:01:17.880 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.command linked to record (asyn reason 2).
2022/07/07 09:01:17.881 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.command linked to record (asyn reason 3).
2022/07/07 09:01:17.883 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.command linked to record (asyn reason 4).
2022/07/07 09:01:17.884 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.command linked to record (asyn reason 5).
2022/07/07 09:01:17.885 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.command linked to record (asyn reason 6).
2022/07/07 09:01:17.886 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.command linked to record (asyn reason 7).
2022/07/07 09:01:17.888 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.command linked to record (asyn reason 8).
2022/07/07 09:01:17.889 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.command linked to record (asyn reason 9).
2022/07/07 09:01:17.890 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.command linked to record (asyn reason 10).
2022/07/07 09:01:17.891 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.command linked to record (asyn reason 11).
2022/07/07 09:01:17.892 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.command linked to record (asyn reason 12).
2022/07/07 09:01:17.894 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.command linked to record (asyn reason 13).
2022/07/07 09:01:17.895 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.command linked to record (asyn reason 14).
2022/07/07 09:01:17.896 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.command linked to record (asyn reason 15).
2022/07/07 09:01:17.898 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.command linked to record (asyn reason 16).
2022/07/07 09:01:17.899 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.command linked to record (asyn reason 17).
2022/07/07 09:01:17.900 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.command linked to record (asyn reason 18).
2022/07/07 09:01:17.902 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.command linked to record (asyn reason 19).
2022/07/07 09:01:17.903 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.command linked to record (asyn reason 20).
2022/07/07 09:01:17.904 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.command linked to record (asyn reason 21).
2022/07/07 09:01:17.906 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.command linked to record (asyn reason 22).
2022/07/07 09:01:17.908 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.command linked to record (asyn reason 23).
2022/07/07 09:01:17.909 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.command linked to record (asyn reason 24).
2022/07/07 09:01:17.910 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.command linked to record (asyn reason 25).
2022/07/07 09:01:17.912 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.command linked to record (asyn reason 26).
2022/07/07 09:01:17.913 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.command linked to record (asyn reason 27).
2022/07/07 09:01:17.915 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.command linked to record (asyn reason 28).
2022/07/07 09:01:17.916 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.command linked to record (asyn reason 29).
2022/07/07 09:01:17.917 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.command linked to record (asyn reason 30).
2022/07/07 09:01:17.919 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.command linked to record (asyn reason 31).
2022/07/07 09:01:17.920 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.targpos linked to record (asyn reason 32).
2022/07/07 09:01:17.921 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.targvelo linked to record (asyn reason 33).
2022/07/07 09:01:17.922 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.targpos linked to record (asyn reason 34).
2022/07/07 09:01:17.923 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.targvelo linked to record (asyn reason 35).
2022/07/07 09:01:17.925 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.targpos linked to record (asyn reason 36).
2022/07/07 09:01:17.926 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.targvelo linked to record (asyn reason 37).
2022/07/07 09:01:17.927 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.targpos linked to record (asyn reason 38).
2022/07/07 09:01:17.928 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.targvelo linked to record (asyn reason 39).
2022/07/07 09:01:17.929 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.targpos linked to record (asyn reason 40).
2022/07/07 09:01:17.931 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.targvelo linked to record (asyn reason 41).
2022/07/07 09:01:17.932 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.targpos linked to record (asyn reason 42).
2022/07/07 09:01:17.933 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.targvelo linked to record (asyn reason 43).
2022/07/07 09:01:17.934 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.targpos linked to record (asyn reason 44).
2022/07/07 09:01:17.935 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.targvelo linked to record (asyn reason 45).
2022/07/07 09:01:17.937 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.targpos linked to record (asyn reason 46).
2022/07/07 09:01:17.938 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.targvelo linked to record (asyn reason 47).
2022/07/07 09:01:17.939 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.targpos linked to record (asyn reason 48).
2022/07/07 09:01:17.940 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.targvelo linked to record (asyn reason 49).
2022/07/07 09:01:17.942 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.targpos linked to record (asyn reason 50).
2022/07/07 09:01:17.943 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.targvelo linked to record (asyn reason 51).
2022/07/07 09:01:17.944 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.targpos linked to record (asyn reason 52).
2022/07/07 09:01:17.945 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.targvelo linked to record (asyn reason 53).
2022/07/07 09:01:17.947 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.targpos linked to record (asyn reason 54).
2022/07/07 09:01:17.948 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.targvelo linked to record (asyn reason 55).
2022/07/07 09:01:17.950 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.targpos linked to record (asyn reason 56).
2022/07/07 09:01:17.951 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.targvelo linked to record (asyn reason 57).
2022/07/07 09:01:17.952 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.targpos linked to record (asyn reason 58).
2022/07/07 09:01:17.953 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.targvelo linked to record (asyn reason 59).
2022/07/07 09:01:17.955 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.targpos linked to record (asyn reason 60).
2022/07/07 09:01:17.956 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.targvelo linked to record (asyn reason 61).
2022/07/07 09:01:17.958 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.targpos linked to record (asyn reason 62).
2022/07/07 09:01:17.959 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.targvelo linked to record (asyn reason 63).
2022/07/07 09:01:17.960 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.targpos linked to record (asyn reason 64).
2022/07/07 09:01:17.962 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.targvelo linked to record (asyn reason 65).
2022/07/07 09:01:17.963 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.targpos linked to record (asyn reason 66).
2022/07/07 09:01:17.965 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.targvelo linked to record (asyn reason 67).
2022/07/07 09:01:17.966 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.targpos linked to record (asyn reason 68).
2022/07/07 09:01:17.968 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.targvelo linked to record (asyn reason 69).
2022/07/07 09:01:17.969 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.targpos linked to record (asyn reason 70).
2022/07/07 09:01:17.970 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.targvelo linked to record (asyn reason 71).
2022/07/07 09:01:17.972 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.targpos linked to record (asyn reason 72).
2022/07/07 09:01:17.973 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.targvelo linked to record (asyn reason 73).
2022/07/07 09:01:17.975 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.targpos linked to record (asyn reason 74).
2022/07/07 09:01:17.976 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.targvelo linked to record (asyn reason 75).
2022/07/07 09:01:17.978 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.targpos linked to record (asyn reason 76).
2022/07/07 09:01:17.980 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.targvelo linked to record (asyn reason 77).
2022/07/07 09:01:17.981 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.targpos linked to record (asyn reason 78).
2022/07/07 09:01:17.983 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.targvelo linked to record (asyn reason 79).
2022/07/07 09:01:17.984 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.targpos linked to record (asyn reason 80).
2022/07/07 09:01:17.986 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.targvelo linked to record (asyn reason 81).
2022/07/07 09:01:17.987 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.targpos linked to record (asyn reason 82).
2022/07/07 09:01:17.989 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.targvelo linked to record (asyn reason 83).
2022/07/07 09:01:17.991 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.targpos linked to record (asyn reason 84).
2022/07/07 09:01:17.992 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.targvelo linked to record (asyn reason 85).
2022/07/07 09:01:17.994 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.targpos linked to record (asyn reason 86).
2022/07/07 09:01:17.995 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.targvelo linked to record (asyn reason 87).
2022/07/07 09:01:17.997 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.targpos linked to record (asyn reason 88).
2022/07/07 09:01:17.999 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.targvelo linked to record (asyn reason 89).
2022/07/07 09:01:18.000 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.targpos linked to record (asyn reason 90).
2022/07/07 09:01:18.002 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.targvelo linked to record (asyn reason 91).
2022/07/07 09:01:18.004 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.status01 linked to record (asyn reason 92).
2022/07/07 09:01:18.005 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.status02 linked to record (asyn reason 93).
2022/07/07 09:01:18.007 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.diagnostic linked to record (asyn reason 94).
2022/07/07 09:01:18.008 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.plc.expression linked to record (asyn reason 95).
2022/07/07 09:01:18.009 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.diagnostic linked to record (asyn reason 96).
2022/07/07 09:01:18.010 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.plc.expression linked to record (asyn reason 97).
2022/07/07 09:01:18.012 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.diagnostic linked to record (asyn reason 98).
2022/07/07 09:01:18.013 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.plc.expression linked to record (asyn reason 99).
2022/07/07 09:01:18.014 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.diagnostic linked to record (asyn reason 100).
2022/07/07 09:01:18.015 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.plc.expression linked to record (asyn reason 101).
2022/07/07 09:01:18.016 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.diagnostic linked to record (asyn reason 102).
2022/07/07 09:01:18.017 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.plc.expression linked to record (asyn reason 103).
2022/07/07 09:01:18.018 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.diagnostic linked to record (asyn reason 104).
2022/07/07 09:01:18.019 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.plc.expression linked to record (asyn reason 105).
2022/07/07 09:01:18.020 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.diagnostic linked to record (asyn reason 106).
2022/07/07 09:01:18.021 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.plc.expression linked to record (asyn reason 107).
2022/07/07 09:01:18.023 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.diagnostic linked to record (asyn reason 108).
2022/07/07 09:01:18.024 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.plc.expression linked to record (asyn reason 109).
2022/07/07 09:01:18.025 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.diagnostic linked to record (asyn reason 110).
2022/07/07 09:01:18.026 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.plc.expression linked to record (asyn reason 111).
2022/07/07 09:01:18.027 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.diagnostic linked to record (asyn reason 112).
2022/07/07 09:01:18.028 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.plc.expression linked to record (asyn reason 113).
2022/07/07 09:01:18.029 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.diagnostic linked to record (asyn reason 114).
2022/07/07 09:01:18.030 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.plc.expression linked to record (asyn reason 115).
2022/07/07 09:01:18.032 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.diagnostic linked to record (asyn reason 116).
2022/07/07 09:01:18.033 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.plc.expression linked to record (asyn reason 117).
2022/07/07 09:01:18.034 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.diagnostic linked to record (asyn reason 118).
2022/07/07 09:01:18.035 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.plc.expression linked to record (asyn reason 119).
2022/07/07 09:01:18.036 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.diagnostic linked to record (asyn reason 120).
2022/07/07 09:01:18.037 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.plc.expression linked to record (asyn reason 121).
2022/07/07 09:01:18.038 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.diagnostic linked to record (asyn reason 122).
2022/07/07 09:01:18.040 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.plc.expression linked to record (asyn reason 123).
2022/07/07 09:01:18.041 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.diagnostic linked to record (asyn reason 124).
2022/07/07 09:01:18.042 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.plc.expression linked to record (asyn reason 125).
2022/07/07 09:01:18.043 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.diagnostic linked to record (asyn reason 126).
2022/07/07 09:01:18.044 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.plc.expression linked to record (asyn reason 127).
2022/07/07 09:01:18.045 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.diagnostic linked to record (asyn reason 128).
2022/07/07 09:01:18.046 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.plc.expression linked to record (asyn reason 129).
2022/07/07 09:01:18.048 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.diagnostic linked to record (asyn reason 130).
2022/07/07 09:01:18.049 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.plc.expression linked to record (asyn reason 131).
2022/07/07 09:01:18.050 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.diagnostic linked to record (asyn reason 132).
2022/07/07 09:01:18.051 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.plc.expression linked to record (asyn reason 133).
2022/07/07 09:01:18.052 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.diagnostic linked to record (asyn reason 134).
2022/07/07 09:01:18.053 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.plc.expression linked to record (asyn reason 135).
2022/07/07 09:01:18.055 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.diagnostic linked to record (asyn reason 136).
2022/07/07 09:01:18.056 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.plc.expression linked to record (asyn reason 137).
2022/07/07 09:01:18.057 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.diagnostic linked to record (asyn reason 138).
2022/07/07 09:01:18.058 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.plc.expression linked to record (asyn reason 139).
2022/07/07 09:01:18.059 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.diagnostic linked to record (asyn reason 140).
2022/07/07 09:01:18.061 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.plc.expression linked to record (asyn reason 141).
2022/07/07 09:01:18.062 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.diagnostic linked to record (asyn reason 142).
2022/07/07 09:01:18.063 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.plc.expression linked to record (asyn reason 143).
2022/07/07 09:01:18.064 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.diagnostic linked to record (asyn reason 144).
2022/07/07 09:01:18.065 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.plc.expression linked to record (asyn reason 145).
2022/07/07 09:01:18.067 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.diagnostic linked to record (asyn reason 146).
2022/07/07 09:01:18.068 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.plc.expression linked to record (asyn reason 147).
2022/07/07 09:01:18.069 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.diagnostic linked to record (asyn reason 148).
2022/07/07 09:01:18.070 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.plc.expression linked to record (asyn reason 149).
2022/07/07 09:01:18.071 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.diagnostic linked to record (asyn reason 150).
2022/07/07 09:01:18.073 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.plc.expression linked to record (asyn reason 151).
2022/07/07 09:01:18.074 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.diagnostic linked to record (asyn reason 152).
2022/07/07 09:01:18.075 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.plc.expression linked to record (asyn reason 153).
2022/07/07 09:01:18.076 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.msg linked to record (asyn reason 154).
2022/07/07 09:01:18.077 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.updated linked to record (asyn reason 155).
2022/07/07 09:01:18.079 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.slavestatus linked to record (asyn reason 156).
2022/07/07 09:01:18.081 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.status linked to record (asyn reason 157).
2022/07/07 09:01:18.083 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.errorid linked to record (asyn reason 158).
2022/07/07 09:01:18.085 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.status linked to record (asyn reason 159).
2022/07/07 09:01:18.087 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.errorid linked to record (asyn reason 160).
2022/07/07 09:01:18.090 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.status linked to record (asyn reason 161).
2022/07/07 09:01:18.092 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.errorid linked to record (asyn reason 162).
2022/07/07 09:01:18.094 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.status linked to record (asyn reason 163).
2022/07/07 09:01:18.096 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.errorid linked to record (asyn reason 164).
2022/07/07 09:01:18.099 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.status linked to record (asyn reason 165).
2022/07/07 09:01:18.101 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.errorid linked to record (asyn reason 166).
2022/07/07 09:01:18.103 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.status linked to record (asyn reason 167).
2022/07/07 09:01:18.105 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.errorid linked to record (asyn reason 168).
2022/07/07 09:01:18.107 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.status linked to record (asyn reason 169).
2022/07/07 09:01:18.110 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.errorid linked to record (asyn reason 170).
2022/07/07 09:01:18.112 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.status linked to record (asyn reason 171).
2022/07/07 09:01:18.114 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.errorid linked to record (asyn reason 172).
2022/07/07 09:01:18.117 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.status linked to record (asyn reason 173).
2022/07/07 09:01:18.119 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.errorid linked to record (asyn reason 174).
2022/07/07 09:01:18.121 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.status linked to record (asyn reason 175).
2022/07/07 09:01:18.123 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.errorid linked to record (asyn reason 176).
2022/07/07 09:01:18.126 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.status linked to record (asyn reason 177).
2022/07/07 09:01:18.128 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.errorid linked to record (asyn reason 178).
2022/07/07 09:01:18.130 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.status linked to record (asyn reason 179).
2022/07/07 09:01:18.133 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.errorid linked to record (asyn reason 180).
2022/07/07 09:01:18.135 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.status linked to record (asyn reason 181).
2022/07/07 09:01:18.137 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.errorid linked to record (asyn reason 182).
2022/07/07 09:01:18.139 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.status linked to record (asyn reason 183).
2022/07/07 09:01:18.141 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.errorid linked to record (asyn reason 184).
2022/07/07 09:01:18.143 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.status linked to record (asyn reason 185).
2022/07/07 09:01:18.145 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.errorid linked to record (asyn reason 186).
2022/07/07 09:01:18.148 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.status linked to record (asyn reason 187).
2022/07/07 09:01:18.150 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.errorid linked to record (asyn reason 188).
2022/07/07 09:01:18.152 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.status linked to record (asyn reason 189).
2022/07/07 09:01:18.154 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.errorid linked to record (asyn reason 190).
2022/07/07 09:01:18.156 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.status linked to record (asyn reason 191).
2022/07/07 09:01:18.159 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.errorid linked to record (asyn reason 192).
2022/07/07 09:01:18.161 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.status linked to record (asyn reason 193).
2022/07/07 09:01:18.163 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.errorid linked to record (asyn reason 194).
2022/07/07 09:01:18.165 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.status linked to record (asyn reason 195).
2022/07/07 09:01:18.167 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.errorid linked to record (asyn reason 196).
2022/07/07 09:01:18.170 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.status linked to record (asyn reason 197).
2022/07/07 09:01:18.172 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.errorid linked to record (asyn reason 198).
2022/07/07 09:01:18.174 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.status linked to record (asyn reason 199).
2022/07/07 09:01:18.177 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.errorid linked to record (asyn reason 200).
2022/07/07 09:01:18.179 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.status linked to record (asyn reason 201).
2022/07/07 09:01:18.181 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.errorid linked to record (asyn reason 202).
2022/07/07 09:01:18.183 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.status linked to record (asyn reason 203).
2022/07/07 09:01:18.186 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.errorid linked to record (asyn reason 204).
2022/07/07 09:01:18.188 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.status linked to record (asyn reason 205).
2022/07/07 09:01:18.190 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.errorid linked to record (asyn reason 206).
2022/07/07 09:01:18.193 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.status linked to record (asyn reason 207).
2022/07/07 09:01:18.195 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.errorid linked to record (asyn reason 208).
2022/07/07 09:01:18.197 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.status linked to record (asyn reason 209).
2022/07/07 09:01:18.200 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.errorid linked to record (asyn reason 210).
2022/07/07 09:01:18.202 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.status linked to record (asyn reason 211).
2022/07/07 09:01:18.204 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.errorid linked to record (asyn reason 212).
2022/07/07 09:01:18.207 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.status linked to record (asyn reason 213).
2022/07/07 09:01:18.209 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.errorid linked to record (asyn reason 214).
2022/07/07 09:01:18.212 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.status linked to record (asyn reason 215).
2022/07/07 09:01:18.214 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.errorid linked to record (asyn reason 216).
2022/07/07 09:01:18.216 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.masterstatus linked to record (asyn reason 217).
2022/07/07 09:01:18.219 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.slavecounter linked to record (asyn reason 218).
2022/07/07 09:01:18.221 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.memmapcounter linked to record (asyn reason 219).
2022/07/07 09:01:18.224 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.domainfailcountertotal linked to record (asyn reason 220).
2022/07/07 09:01:18.226 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.entrycounter linked to record (asyn reason 221).
2022/07/07 09:01:18.228 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.domainstatus linked to record (asyn reason 222).
2022/07/07 09:01:18.231 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.binaryInput01 linked to record (asyn reason 223).
2022/07/07 09:01:18.234 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.binaryInput02 linked to record (asyn reason 224).
2022/07/07 09:01:18.238 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax1.plc.enable linked to record (asyn reason 225).
2022/07/07 09:01:18.241 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax1.plc.firstscan linked to record (asyn reason 226).
2022/07/07 09:01:18.244 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax2.plc.enable linked to record (asyn reason 227).
2022/07/07 09:01:18.248 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax2.plc.firstscan linked to record (asyn reason 228).
2022/07/07 09:01:18.251 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax3.plc.enable linked to record (asyn reason 229).
2022/07/07 09:01:18.255 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax3.plc.firstscan linked to record (asyn reason 230).
2022/07/07 09:01:18.258 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax4.plc.enable linked to record (asyn reason 231).
2022/07/07 09:01:18.262 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax4.plc.firstscan linked to record (asyn reason 232).
2022/07/07 09:01:18.265 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax5.plc.enable linked to record (asyn reason 233).
2022/07/07 09:01:18.269 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax5.plc.firstscan linked to record (asyn reason 234).
2022/07/07 09:01:18.273 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax6.plc.enable linked to record (asyn reason 235).
2022/07/07 09:01:18.276 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax6.plc.firstscan linked to record (asyn reason 236).
2022/07/07 09:01:18.280 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax7.plc.enable linked to record (asyn reason 237).
2022/07/07 09:01:18.284 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax7.plc.firstscan linked to record (asyn reason 238).
2022/07/07 09:01:18.288 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax8.plc.enable linked to record (asyn reason 239).
2022/07/07 09:01:18.291 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax8.plc.firstscan linked to record (asyn reason 240).
2022/07/07 09:01:18.295 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax9.plc.enable linked to record (asyn reason 241).
2022/07/07 09:01:18.299 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax9.plc.firstscan linked to record (asyn reason 242).
2022/07/07 09:01:18.303 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax10.plc.enable linked to record (asyn reason 243).
2022/07/07 09:01:18.307 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax10.plc.firstscan linked to record (asyn reason 244).
2022/07/07 09:01:18.311 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax11.plc.enable linked to record (asyn reason 245).
2022/07/07 09:01:18.314 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax11.plc.firstscan linked to record (asyn reason 246).
2022/07/07 09:01:18.318 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax12.plc.enable linked to record (asyn reason 247).
2022/07/07 09:01:18.322 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax12.plc.firstscan linked to record (asyn reason 248).
2022/07/07 09:01:18.326 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax13.plc.enable linked to record (asyn reason 249).
2022/07/07 09:01:18.330 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax13.plc.firstscan linked to record (asyn reason 250).
2022/07/07 09:01:18.334 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax14.plc.enable linked to record (asyn reason 251).
2022/07/07 09:01:18.339 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax14.plc.firstscan linked to record (asyn reason 252).
2022/07/07 09:01:18.343 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax15.plc.enable linked to record (asyn reason 253).
2022/07/07 09:01:18.348 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax15.plc.firstscan linked to record (asyn reason 254).
2022/07/07 09:01:18.352 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax16.plc.enable linked to record (asyn reason 255).
2022/07/07 09:01:18.356 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax16.plc.firstscan linked to record (asyn reason 256).
2022/07/07 09:01:18.361 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax17.plc.enable linked to record (asyn reason 257).
2022/07/07 09:01:18.365 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax17.plc.firstscan linked to record (asyn reason 258).
2022/07/07 09:01:18.369 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax18.plc.enable linked to record (asyn reason 259).
2022/07/07 09:01:18.374 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax18.plc.firstscan linked to record (asyn reason 260).
2022/07/07 09:01:18.378 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax19.plc.enable linked to record (asyn reason 261).
2022/07/07 09:01:18.382 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax19.plc.firstscan linked to record (asyn reason 262).
2022/07/07 09:01:18.387 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax20.plc.enable linked to record (asyn reason 263).
2022/07/07 09:01:18.391 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax20.plc.firstscan linked to record (asyn reason 264).
2022/07/07 09:01:18.396 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax21.plc.enable linked to record (asyn reason 265).
2022/07/07 09:01:18.400 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax21.plc.firstscan linked to record (asyn reason 266).
2022/07/07 09:01:18.405 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax22.plc.enable linked to record (asyn reason 267).
2022/07/07 09:01:18.409 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax22.plc.firstscan linked to record (asyn reason 268).
2022/07/07 09:01:18.414 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax23.plc.enable linked to record (asyn reason 269).
2022/07/07 09:01:18.418 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax23.plc.firstscan linked to record (asyn reason 270).
2022/07/07 09:01:18.423 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax24.plc.enable linked to record (asyn reason 271).
2022/07/07 09:01:18.428 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax24.plc.firstscan linked to record (asyn reason 272).
2022/07/07 09:01:18.432 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax25.plc.enable linked to record (asyn reason 273).
2022/07/07 09:01:18.437 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax25.plc.firstscan linked to record (asyn reason 274).
2022/07/07 09:01:18.442 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax26.plc.enable linked to record (asyn reason 275).
2022/07/07 09:01:18.447 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax26.plc.firstscan linked to record (asyn reason 276).
2022/07/07 09:01:18.451 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax27.plc.enable linked to record (asyn reason 277).
2022/07/07 09:01:18.456 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax27.plc.firstscan linked to record (asyn reason 278).
2022/07/07 09:01:18.461 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax28.plc.enable linked to record (asyn reason 279).
2022/07/07 09:01:18.466 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax28.plc.firstscan linked to record (asyn reason 280).
2022/07/07 09:01:18.471 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax29.plc.enable linked to record (asyn reason 281).
2022/07/07 09:01:18.476 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax29.plc.firstscan linked to record (asyn reason 282).
2022/07/07 09:01:18.481 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax30.plc.enable linked to record (asyn reason 283).
2022/07/07 09:01:18.486 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax30.plc.firstscan linked to record (asyn reason 284).
2022/07/07 09:01:18.491 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.ok linked to record (asyn reason 285).
2022/07/07 09:01:18.496 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.control linked to record (asyn reason 286).
2022/07/07 09:01:18.500 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.control linked to record (asyn reason 287).
2022/07/07 09:01:18.504 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.control linked to record (asyn reason 288).
2022/07/07 09:01:18.508 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.control linked to record (asyn reason 289).
2022/07/07 09:01:18.511 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.control linked to record (asyn reason 290).
2022/07/07 09:01:18.515 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.control linked to record (asyn reason 291).
2022/07/07 09:01:18.519 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.control linked to record (asyn reason 292).
2022/07/07 09:01:18.523 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.control linked to record (asyn reason 293).
2022/07/07 09:01:18.527 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.control linked to record (asyn reason 294).
2022/07/07 09:01:18.531 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.control linked to record (asyn reason 295).
2022/07/07 09:01:18.534 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.control linked to record (asyn reason 296).
2022/07/07 09:01:18.538 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.control linked to record (asyn reason 297).
2022/07/07 09:01:18.542 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.control linked to record (asyn reason 298).
2022/07/07 09:01:18.546 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.control linked to record (asyn reason 299).
2022/07/07 09:01:18.550 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.control linked to record (asyn reason 300).
2022/07/07 09:01:18.554 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.control linked to record (asyn reason 301).
2022/07/07 09:01:18.558 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.control linked to record (asyn reason 302).
2022/07/07 09:01:18.562 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.control linked to record (asyn reason 303).
2022/07/07 09:01:18.566 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.control linked to record (asyn reason 304).
2022/07/07 09:01:18.570 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.control linked to record (asyn reason 305).
2022/07/07 09:01:18.575 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.control linked to record (asyn reason 306).
2022/07/07 09:01:18.579 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.control linked to record (asyn reason 307).
2022/07/07 09:01:18.583 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.control linked to record (asyn reason 308).
2022/07/07 09:01:18.588 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.control linked to record (asyn reason 309).
2022/07/07 09:01:18.592 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.control linked to record (asyn reason 310).
2022/07/07 09:01:18.596 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.control linked to record (asyn reason 311).
2022/07/07 09:01:18.601 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.control linked to record (asyn reason 312).
2022/07/07 09:01:18.605 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.control linked to record (asyn reason 313).
2022/07/07 09:01:18.609 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.control linked to record (asyn reason 314).
2022/07/07 09:01:18.613 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.control linked to record (asyn reason 315).
2022/07/07 09:01:18.617 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.ONE linked to record (asyn reason 316).
2022/07/07 09:01:18.621 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.ZERO linked to record (asyn reason 317).
2022/07/07 09:01:18.625 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.cmddata linked to record (asyn reason 318).
2022/07/07 09:01:18.629 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.cmddata linked to record (asyn reason 319).
2022/07/07 09:01:18.633 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.cmddata linked to record (asyn reason 320).
2022/07/07 09:01:18.637 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.cmddata linked to record (asyn reason 321).
2022/07/07 09:01:18.641 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.cmddata linked to record (asyn reason 322).
2022/07/07 09:01:18.645 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.cmddata linked to record (asyn reason 323).
2022/07/07 09:01:18.650 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.cmddata linked to record (asyn reason 324).
2022/07/07 09:01:18.654 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.cmddata linked to record (asyn reason 325).
2022/07/07 09:01:18.658 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.cmddata linked to record (asyn reason 326).
2022/07/07 09:01:18.662 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.cmddata linked to record (asyn reason 327).
2022/07/07 09:01:18.666 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.cmddata linked to record (asyn reason 328).
2022/07/07 09:01:18.670 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.cmddata linked to record (asyn reason 329).
2022/07/07 09:01:18.675 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.cmddata linked to record (asyn reason 330).
2022/07/07 09:01:18.679 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.cmddata linked to record (asyn reason 331).
2022/07/07 09:01:18.683 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.cmddata linked to record (asyn reason 332).
2022/07/07 09:01:18.687 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.cmddata linked to record (asyn reason 333).
2022/07/07 09:01:18.691 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.cmddata linked to record (asyn reason 334).
2022/07/07 09:01:18.696 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.cmddata linked to record (asyn reason 335).
2022/07/07 09:01:18.700 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.cmddata linked to record (asyn reason 336).
2022/07/07 09:01:18.704 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.cmddata linked to record (asyn reason 337).
2022/07/07 09:01:18.708 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.cmddata linked to record (asyn reason 338).
2022/07/07 09:01:18.713 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.cmddata linked to record (asyn reason 339).
2022/07/07 09:01:18.717 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.cmddata linked to record (asyn reason 340).
2022/07/07 09:01:18.721 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.cmddata linked to record (asyn reason 341).
2022/07/07 09:01:18.725 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.cmddata linked to record (asyn reason 342).
2022/07/07 09:01:18.730 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.cmddata linked to record (asyn reason 343).
2022/07/07 09:01:18.734 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.cmddata linked to record (asyn reason 344).
2022/07/07 09:01:18.738 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.cmddata linked to record (asyn reason 345).
2022/07/07 09:01:18.743 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.cmddata linked to record (asyn reason 346).
2022/07/07 09:01:18.747 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.cmddata linked to record (asyn reason 347).
tern>
# List all ecmc params for ethercat slave 2:
# ecmcGrepParam *s2*
#
ecmcEpicsEnvSetCalcTernary(ECMC_MASTER_CMD, "0>=0", "","#- ")
 ecmcFileExist("ecmcEc.db",1,1)
 dbLoadRecords("ecmcEc.db","P=IOC_MTCA:,ECMC_EC_MP=m,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,T_SMP_MS=10,TSE=-2")
ecmcConfigOrDie "Cfg.SetAppMode(1)"
iocInit()
############################################################################
## EPICS R7.0.6.1-E3-7.0.6.1-patch
## Rev. 2022-03-11T15:27+0100
############################################################################
ECATtimestamp aSubRecord: IOC_MTCA:m0s002-BI01-TimeRiseTS
ECATtimestamp aSubRecord: IOC_MTCA:m0s002-BI01-TimeFallTS
ECATtimestamp aSubRecord: IOC_MTCA:m0s002-BI02-TimeRiseTS
ECATtimestamp aSubRecord: IOC_MTCA:m0s002-BI02-TimeFallTS
2022/07/07 09:01:18.751 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.timestampLatchPositive01 linked to record (asyn reason 348).
2022/07/07 09:01:18.756 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.timestampLatchNegative01 linked to record (asyn reason 349).
2022/07/07 09:01:18.760 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.timestampLatchPositive02 linked to record (asyn reason 350).
2022/07/07 09:01:18.764 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s2.timestampLatchNegative02 linked to record (asyn reason 351).
2022/07/07 09:01:18.769 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.actpos linked to record (asyn reason 352).
2022/07/07 09:01:18.773 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.setpos linked to record (asyn reason 353).
2022/07/07 09:01:18.777 ecmcAsynPortDriver:drvUserCreate: Parameter ax1.poserr linked to record (asyn reason 354).
2022/07/07 09:01:18.781 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax1.plc.error linked to record (asyn reason 355).
2022/07/07 09:01:18.786 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.actpos linked to record (asyn reason 356).
2022/07/07 09:01:18.790 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.setpos linked to record (asyn reason 357).
2022/07/07 09:01:18.795 ecmcAsynPortDriver:drvUserCreate: Parameter ax2.poserr linked to record (asyn reason 358).
2022/07/07 09:01:18.799 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax2.plc.error linked to record (asyn reason 359).
2022/07/07 09:01:18.804 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.actpos linked to record (asyn reason 360).
2022/07/07 09:01:18.808 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.setpos linked to record (asyn reason 361).
2022/07/07 09:01:18.813 ecmcAsynPortDriver:drvUserCreate: Parameter ax3.poserr linked to record (asyn reason 362).
2022/07/07 09:01:18.817 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax3.plc.error linked to record (asyn reason 363).
2022/07/07 09:01:18.822 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.actpos linked to record (asyn reason 364).
2022/07/07 09:01:18.826 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.setpos linked to record (asyn reason 365).
2022/07/07 09:01:18.830 ecmcAsynPortDriver:drvUserCreate: Parameter ax4.poserr linked to record (asyn reason 366).
2022/07/07 09:01:18.835 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax4.plc.error linked to record (asyn reason 367).
2022/07/07 09:01:18.840 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.actpos linked to record (asyn reason 368).
2022/07/07 09:01:18.844 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.setpos linked to record (asyn reason 369).
2022/07/07 09:01:18.849 ecmcAsynPortDriver:drvUserCreate: Parameter ax5.poserr linked to record (asyn reason 370).
2022/07/07 09:01:18.853 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax5.plc.error linked to record (asyn reason 371).
2022/07/07 09:01:18.858 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.actpos linked to record (asyn reason 372).
2022/07/07 09:01:18.862 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.setpos linked to record (asyn reason 373).
2022/07/07 09:01:18.867 ecmcAsynPortDriver:drvUserCreate: Parameter ax6.poserr linked to record (asyn reason 374).
2022/07/07 09:01:18.872 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax6.plc.error linked to record (asyn reason 375).
2022/07/07 09:01:18.876 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.actpos linked to record (asyn reason 376).
2022/07/07 09:01:18.881 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.setpos linked to record (asyn reason 377).
2022/07/07 09:01:18.886 ecmcAsynPortDriver:drvUserCreate: Parameter ax7.poserr linked to record (asyn reason 378).
2022/07/07 09:01:18.890 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax7.plc.error linked to record (asyn reason 379).
2022/07/07 09:01:18.895 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.actpos linked to record (asyn reason 380).
2022/07/07 09:01:18.900 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.setpos linked to record (asyn reason 381).
2022/07/07 09:01:18.905 ecmcAsynPortDriver:drvUserCreate: Parameter ax8.poserr linked to record (asyn reason 382).
2022/07/07 09:01:18.909 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax8.plc.error linked to record (asyn reason 383).
2022/07/07 09:01:18.914 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.actpos linked to record (asyn reason 384).
2022/07/07 09:01:18.919 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.setpos linked to record (asyn reason 385).
2022/07/07 09:01:18.924 ecmcAsynPortDriver:drvUserCreate: Parameter ax9.poserr linked to record (asyn reason 386).
2022/07/07 09:01:18.928 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax9.plc.error linked to record (asyn reason 387).
2022/07/07 09:01:18.933 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.actpos linked to record (asyn reason 388).
2022/07/07 09:01:18.938 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.setpos linked to record (asyn reason 389).
2022/07/07 09:01:18.943 ecmcAsynPortDriver:drvUserCreate: Parameter ax10.poserr linked to record (asyn reason 390).
2022/07/07 09:01:18.948 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax10.plc.error linked to record (asyn reason 391).
2022/07/07 09:01:18.953 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.actpos linked to record (asyn reason 392).
2022/07/07 09:01:18.957 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.setpos linked to record (asyn reason 393).
2022/07/07 09:01:18.963 ecmcAsynPortDriver:drvUserCreate: Parameter ax11.poserr linked to record (asyn reason 394).
2022/07/07 09:01:18.968 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax11.plc.error linked to record (asyn reason 395).
2022/07/07 09:01:18.973 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.actpos linked to record (asyn reason 396).
2022/07/07 09:01:18.978 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.setpos linked to record (asyn reason 397).
2022/07/07 09:01:18.983 ecmcAsynPortDriver:drvUserCreate: Parameter ax12.poserr linked to record (asyn reason 398).
2022/07/07 09:01:18.987 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax12.plc.error linked to record (asyn reason 399).
2022/07/07 09:01:18.993 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.actpos linked to record (asyn reason 400).
2022/07/07 09:01:18.997 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.setpos linked to record (asyn reason 401).
2022/07/07 09:01:19.002 ecmcAsynPortDriver:drvUserCreate: Parameter ax13.poserr linked to record (asyn reason 402).
2022/07/07 09:01:19.007 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax13.plc.error linked to record (asyn reason 403).
2022/07/07 09:01:19.013 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.actpos linked to record (asyn reason 404).
2022/07/07 09:01:19.019 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.setpos linked to record (asyn reason 405).
2022/07/07 09:01:19.024 ecmcAsynPortDriver:drvUserCreate: Parameter ax14.poserr linked to record (asyn reason 406).
2022/07/07 09:01:19.030 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax14.plc.error linked to record (asyn reason 407).
2022/07/07 09:01:19.036 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.actpos linked to record (asyn reason 408).
2022/07/07 09:01:19.041 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.setpos linked to record (asyn reason 409).
2022/07/07 09:01:19.047 ecmcAsynPortDriver:drvUserCreate: Parameter ax15.poserr linked to record (asyn reason 410).
2022/07/07 09:01:19.052 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax15.plc.error linked to record (asyn reason 411).
2022/07/07 09:01:19.057 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.actpos linked to record (asyn reason 412).
2022/07/07 09:01:19.063 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.setpos linked to record (asyn reason 413).
2022/07/07 09:01:19.068 ecmcAsynPortDriver:drvUserCreate: Parameter ax16.poserr linked to record (asyn reason 414).
2022/07/07 09:01:19.073 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax16.plc.error linked to record (asyn reason 415).
2022/07/07 09:01:19.078 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.actpos linked to record (asyn reason 416).
2022/07/07 09:01:19.083 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.setpos linked to record (asyn reason 417).
2022/07/07 09:01:19.089 ecmcAsynPortDriver:drvUserCreate: Parameter ax17.poserr linked to record (asyn reason 418).
2022/07/07 09:01:19.094 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax17.plc.error linked to record (asyn reason 419).
2022/07/07 09:01:19.100 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.actpos linked to record (asyn reason 420).
2022/07/07 09:01:19.105 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.setpos linked to record (asyn reason 421).
2022/07/07 09:01:19.111 ecmcAsynPortDriver:drvUserCreate: Parameter ax18.poserr linked to record (asyn reason 422).
2022/07/07 09:01:19.117 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax18.plc.error linked to record (asyn reason 423).
2022/07/07 09:01:19.123 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.actpos linked to record (asyn reason 424).
2022/07/07 09:01:19.129 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.setpos linked to record (asyn reason 425).
2022/07/07 09:01:19.135 ecmcAsynPortDriver:drvUserCreate: Parameter ax19.poserr linked to record (asyn reason 426).
2022/07/07 09:01:19.140 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax19.plc.error linked to record (asyn reason 427).
2022/07/07 09:01:19.146 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.actpos linked to record (asyn reason 428).
2022/07/07 09:01:19.151 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.setpos linked to record (asyn reason 429).
2022/07/07 09:01:19.156 ecmcAsynPortDriver:drvUserCreate: Parameter ax20.poserr linked to record (asyn reason 430).
2022/07/07 09:01:19.162 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax20.plc.error linked to record (asyn reason 431).
2022/07/07 09:01:19.167 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.actpos linked to record (asyn reason 432).
2022/07/07 09:01:19.173 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.setpos linked to record (asyn reason 433).
2022/07/07 09:01:19.178 ecmcAsynPortDriver:drvUserCreate: Parameter ax21.poserr linked to record (asyn reason 434).
2022/07/07 09:01:19.183 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax21.plc.error linked to record (asyn reason 435).
2022/07/07 09:01:19.189 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.actpos linked to record (asyn reason 436).
2022/07/07 09:01:19.194 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.setpos linked to record (asyn reason 437).
2022/07/07 09:01:19.200 ecmcAsynPortDriver:drvUserCreate: Parameter ax22.poserr linked to record (asyn reason 438).
2022/07/07 09:01:19.205 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax22.plc.error linked to record (asyn reason 439).
2022/07/07 09:01:19.211 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.actpos linked to record (asyn reason 440).
2022/07/07 09:01:19.216 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.setpos linked to record (asyn reason 441).
2022/07/07 09:01:19.222 ecmcAsynPortDriver:drvUserCreate: Parameter ax23.poserr linked to record (asyn reason 442).
2022/07/07 09:01:19.227 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax23.plc.error linked to record (asyn reason 443).
2022/07/07 09:01:19.233 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.actpos linked to record (asyn reason 444).
2022/07/07 09:01:19.239 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.setpos linked to record (asyn reason 445).
2022/07/07 09:01:19.245 ecmcAsynPortDriver:drvUserCreate: Parameter ax24.poserr linked to record (asyn reason 446).
2022/07/07 09:01:19.251 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax24.plc.error linked to record (asyn reason 447).
2022/07/07 09:01:19.258 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.actpos linked to record (asyn reason 448).
2022/07/07 09:01:19.264 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.setpos linked to record (asyn reason 449).
2022/07/07 09:01:19.270 ecmcAsynPortDriver:drvUserCreate: Parameter ax25.poserr linked to record (asyn reason 450).
2022/07/07 09:01:19.277 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax25.plc.error linked to record (asyn reason 451).
2022/07/07 09:01:19.283 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.actpos linked to record (asyn reason 452).
2022/07/07 09:01:19.290 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.setpos linked to record (asyn reason 453).
2022/07/07 09:01:19.296 ecmcAsynPortDriver:drvUserCreate: Parameter ax26.poserr linked to record (asyn reason 454).
2022/07/07 09:01:19.302 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax26.plc.error linked to record (asyn reason 455).
2022/07/07 09:01:19.309 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.actpos linked to record (asyn reason 456).
2022/07/07 09:01:19.315 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.setpos linked to record (asyn reason 457).
2022/07/07 09:01:19.322 ecmcAsynPortDriver:drvUserCreate: Parameter ax27.poserr linked to record (asyn reason 458).
2022/07/07 09:01:19.328 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax27.plc.error linked to record (asyn reason 459).
2022/07/07 09:01:19.335 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.actpos linked to record (asyn reason 460).
2022/07/07 09:01:19.342 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.setpos linked to record (asyn reason 461).
2022/07/07 09:01:19.348 ecmcAsynPortDriver:drvUserCreate: Parameter ax28.poserr linked to record (asyn reason 462).
2022/07/07 09:01:19.354 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax28.plc.error linked to record (asyn reason 463).
2022/07/07 09:01:19.360 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.actpos linked to record (asyn reason 464).
2022/07/07 09:01:19.366 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.setpos linked to record (asyn reason 465).
2022/07/07 09:01:19.372 ecmcAsynPortDriver:drvUserCreate: Parameter ax29.poserr linked to record (asyn reason 466).
2022/07/07 09:01:19.378 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax29.plc.error linked to record (asyn reason 467).
2022/07/07 09:01:19.384 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.actpos linked to record (asyn reason 468).
2022/07/07 09:01:19.390 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.setpos linked to record (asyn reason 469).
2022/07/07 09:01:19.396 ecmcAsynPortDriver:drvUserCreate: Parameter ax30.poserr linked to record (asyn reason 470).
2022/07/07 09:01:19.401 ecmcAsynPortDriver:drvUserCreate: Parameter plcs.ax30.plc.error linked to record (asyn reason 471).
2022/07/07 09:01:19.407 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.appmode linked to record (asyn reason 472).
2022/07/07 09:01:19.413 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.id linked to record (asyn reason 473).
2022/07/07 09:01:19.419 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.latency.min linked to record (asyn reason 474).
2022/07/07 09:01:19.425 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.latency.max linked to record (asyn reason 475).
2022/07/07 09:01:19.431 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.period.min linked to record (asyn reason 476).
2022/07/07 09:01:19.437 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.period.max linked to record (asyn reason 477).
2022/07/07 09:01:19.443 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.execute.min linked to record (asyn reason 478).
2022/07/07 09:01:19.449 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.execute.max linked to record (asyn reason 479).
2022/07/07 09:01:19.455 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.send.min linked to record (asyn reason 480).
2022/07/07 09:01:19.461 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.send.max linked to record (asyn reason 481).
2022/07/07 09:01:19.463 ecmcMotorRecord:: setIntegerParam(1 motorUpdateStatus_)=0
2022/07/07 09:01:19.464 ecmcMotorRecord:: setIntegerParam(2 motorUpdateStatus_)=0
2022/07/07 09:01:19.464 ecmcMotorRecord:: setIntegerParam(3 motorUpdateStatus_)=0
2022/07/07 09:01:19.463 [devMotorAsyn.c:439  IOC_MTCA:Axis1] init_record IOC_MTCA:Axis1 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.463 [devMotorAsyn.c:185  IOC_MTCA:Axis1] init_controller IOC_MTCA:Axis1 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.463 [devMotorAsyn.c:266  IOC_MTCA:Axis1] update_soft_limits IOC_MTCA:Axis1 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.463 [motorDevSup.c:327  IOC_MTCA:Axis1] PositionRestoreNeeded IOC_MTCA:Axis1 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.463 [motorRecord.cc:782  IOC_MTCA:Axis1] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.463 [motorRecord.cc:720  IOC_MTCA:Axis1] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.463 [motorRecord.cc:833  IOC_MTCA:Axis1] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.463 [motorRecord.cc:968  IOC_MTCA:Axis1] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.463 [devMotorAsyn.c:439  IOC_MTCA:Axis2] init_record IOC_MTCA:Axis2 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.463 [devMotorAsyn.c:185  IOC_MTCA:Axis2] init_controller IOC_MTCA:Axis2 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.463 [devMotorAsyn.c:266  IOC_MTCA:Axis2] update_soft_limits IOC_MTCA:Axis2 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.463 [motorDevSup.c:327  IOC_MTCA:Axis2] PositionRestoreNeeded IOC_MTCA:Axis2 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.463 [motorRecord.cc:782  IOC_MTCA:Axis2] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.463 [motorRecord.cc:720  IOC_MTCA:Axis2] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.463 [motorRecord.cc:833  IOC_MTCA:Axis2] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.464 [motorRecord.cc:968  IOC_MTCA:Axis2] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:439  IOC_MTCA:Axis3] init_record IOC_MTCA:Axis3 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.464 [devMotorAsyn.c:185  IOC_MTCA:Axis3] init_controller IOC_MTCA:Axis3 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:266  IOC_MTCA:Axis3] update_soft_limits IOC_MTCA:Axis3 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.464 [motorDevSup.c:327  IOC_MTCA:Axis3] PositionRestoreNeeded IOC_MTCA:Axis3 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.464 [motorRecord.cc:782  IOC_MTCA:Axis3] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.464 [motorRecord.cc:720  IOC_MTCA:Axis3] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.464 [motorRecord.cc:833  IOC_MTCA:Axis3] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.464 [motorRecord.cc:968  IOC_MTCA:Axis3] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:439  IOC_MTCA:Axis4] init_record IOC_MTCA:Axis4 position=0.000000 encoderPos=0.002022/07/07 09:01:19.464 ecmcMotorRecord:: setIntegerParam(4 motorUpdateStatus_)=0
2022/07/07 09:01:19.464 ecmcMotorRecord:: setIntegerParam(5 motorUpdateStatus_)=0
2022/07/07 09:01:19.464 ecmcMotorRecord:: setIntegerParam(6 motorUpdateStatus_)=0
0000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.464 [devMotorAsyn.c:185  IOC_MTCA:Axis4] init_controller IOC_MTCA:Axis4 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:266  IOC_MTCA:Axis4] update_soft_limits IOC_MTCA:Axis4 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.464 [motorDevSup.c:327  IOC_MTCA:Axis4] PositionRestoreNeeded IOC_MTCA:Axis4 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.464 [motorRecord.cc:782  IOC_MTCA:Axis4] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.464 [motorRecord.cc:720  IOC_MTCA:Axis4] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.464 [motorRecord.cc:833  IOC_MTCA:Axis4] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.464 [motorRecord.cc:968  IOC_MTCA:Axis4] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:439  IOC_MTCA:Axis5] init_record IOC_MTCA:Axis5 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.464 [devMotorAsyn.c:185  IOC_MTCA:Axis5] init_controller IOC_MTCA:Axis5 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:266  IOC_MTCA:Axis5] update_soft_limits IOC_MTCA:Axis5 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.464 [motorDevSup.c:327  IOC_MTCA:Axis5] PositionRestoreNeeded IOC_MTCA:Axis5 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.464 [motorRecord.cc:782  IOC_MTCA:Axis5] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.464 [motorRecord.cc:720  IOC_MTCA:Axis5] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.464 [motorRecord.cc:833  IOC_MTCA:Axis5] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.464 [motorRecord.cc:968  IOC_MTCA:Axis5] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:439  IOC_MTCA:Axis6] init_record IOC_MTCA:Axis6 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.464 [devMotorAsyn.c:185  IOC_MTCA:Axis6] init_controller IOC_MTCA:Axis6 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:266  IOC_MTCA:Axis6] update_soft_limits IOC_MTCA:Axis6 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.464 [motorDevSup.c:327  IOC_MTCA:Axis6] PositionRestoreNeeded IOC_MTCA:Axis6 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.464 [motorRecord.cc:782  IOC_MTCA:Axis6] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.464 [motorRecord.cc:720  IOC_MTCA:Axis6] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.464 [motorRecord.cc:833  IOC_MTCA:Axis6] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.464 [motorRecord.cc:968  IOC_MTCA:Axis6] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:439  IOC_MTCA:Axis7] init_record IOC_MTCA:Axis7 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.464 [devMoto2022/07/07 09:01:19.464 ecmcMotorRecord:: setIntegerParam(7 motorUpdateStatus_)=0
2022/07/07 09:01:19.464 ecmcMotorRecord:: setIntegerParam(8 motorUpdateStatus_)=0
2022/07/07 09:01:19.465 ecmcMotorRecord:: setIntegerParam(9 motorUpdateStatus_)=0
rAsyn.c:185  IOC_MTCA:Axis7] init_controller IOC_MTCA:Axis7 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:266  IOC_MTCA:Axis7] update_soft_limits IOC_MTCA:Axis7 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.464 [motorDevSup.c:327  IOC_MTCA:Axis7] PositionRestoreNeeded IOC_MTCA:Axis7 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.464 [motorRecord.cc:782  IOC_MTCA:Axis7] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.464 [motorRecord.cc:720  IOC_MTCA:Axis7] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.464 [motorRecord.cc:833  IOC_MTCA:Axis7] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.464 [motorRecord.cc:968  IOC_MTCA:Axis7] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:439  IOC_MTCA:Axis8] init_record IOC_MTCA:Axis8 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.464 [devMotorAsyn.c:185  IOC_MTCA:Axis8] init_controller IOC_MTCA:Axis8 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.464 [devMotorAsyn.c:266  IOC_MTCA:Axis8] update_soft_limits IOC_MTCA:Axis8 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.464 [motorDevSup.c:327  IOC_MTCA:Axis8] PositionRestoreNeeded IOC_MTCA:Axis8 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.464 [motorRecord.cc:782  IOC_MTCA:Axis8] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.464 [motorRecord.cc:720  IOC_MTCA:Axis8] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.464 [motorRecord.cc:833  IOC_MTCA:Axis8] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.464 [motorRecord.cc:968  IOC_MTCA:Axis8] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:439  IOC_MTCA:Axis9] init_record IOC_MTCA:Axis9 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.465 [devMotorAsyn.c:185  IOC_MTCA:Axis9] init_controller IOC_MTCA:Axis9 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:266  IOC_MTCA:Axis9] update_soft_limits IOC_MTCA:Axis9 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.465 [motorDevSup.c:327  IOC_MTCA:Axis9] PositionRestoreNeeded IOC_MTCA:Axis9 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.465 [motorRecord.cc:782  IOC_MTCA:Axis9] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.465 [motorRecord.cc:720  IOC_MTCA:Axis9] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.465 [motorRecord.cc:833  IOC_MTCA:Axis9] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.465 [motorRecord.cc:968  IOC_MTCA:Axis9] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:439  IOC_MTCA:Axis10] init_record IOC_MTCA:Axis10 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.465 [devMotorAsyn.c:185  IOC_MTCA:Axis10] init_controller IOC_MTCA:Axis10 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.42022/07/07 09:01:19.465 ecmcMotorRecord:: setIntegerParam(10 motorUpdateStatus_)=0
2022/07/07 09:01:19.465 ecmcMotorRecord:: setIntegerParam(11 motorUpdateStatus_)=0
2022/07/07 09:01:19.465 ecmcMotorRecord:: setIntegerParam(12 motorUpdateStatus_)=0
65 [devMotorAsyn.c:266  IOC_MTCA:Axis10] update_soft_limits IOC_MTCA:Axis10 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.465 [motorDevSup.c:327  IOC_MTCA:Axis10] PositionRestoreNeeded IOC_MTCA:Axis10 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.465 [motorRecord.cc:782  IOC_MTCA:Axis10] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.465 [motorRecord.cc:720  IOC_MTCA:Axis10] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.465 [motorRecord.cc:833  IOC_MTCA:Axis10] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.465 [motorRecord.cc:968  IOC_MTCA:Axis10] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:439  IOC_MTCA:Axis11] init_record IOC_MTCA:Axis11 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.465 [devMotorAsyn.c:185  IOC_MTCA:Axis11] init_controller IOC_MTCA:Axis11 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:266  IOC_MTCA:Axis11] update_soft_limits IOC_MTCA:Axis11 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.465 [motorDevSup.c:327  IOC_MTCA:Axis11] PositionRestoreNeeded IOC_MTCA:Axis11 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.465 [motorRecord.cc:782  IOC_MTCA:Axis11] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.465 [motorRecord.cc:720  IOC_MTCA:Axis11] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.465 [motorRecord.cc:833  IOC_MTCA:Axis11] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.465 [motorRecord.cc:968  IOC_MTCA:Axis11] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:439  IOC_MTCA:Axis12] init_record IOC_MTCA:Axis12 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.465 [devMotorAsyn.c:185  IOC_MTCA:Axis12] init_controller IOC_MTCA:Axis12 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:266  IOC_MTCA:Axis12] update_soft_limits IOC_MTCA:Axis12 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.465 [motorDevSup.c:327  IOC_MTCA:Axis12] PositionRestoreNeeded IOC_MTCA:Axis12 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.465 [motorRecord.cc:782  IOC_MTCA:Axis12] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.465 [motorRecord.cc:720  IOC_MTCA:Axis12] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.465 [motorRecord.cc:833  IOC_MTCA:Axis12] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.465 [motorRecord.cc:968  IOC_MTCA:Axis12] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:439  IOC_MTCA:Axis13] init_record IOC_MTCA:Axis13 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.465 [devMotorAsyn.c:185  IOC_MTCA:Axis13] init_controller IOC_MTCA:Axis13 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.465 [devMotorAsyn.c:266  IOC_MTCA:Axis13] update_soft_limits IOC_MTCA:Axis13 RawHLM_RO2022/07/07 09:01:19.465 ecmcMotorRecord:: setIntegerParam(13 motorUpdateStatus_)=0
2022/07/07 09:01:19.466 ecmcMotorRecord:: setIntegerParam(14 motorUpdateStatus_)=0
2022/07/07 09:01:19.466 ecmcMotorRecord:: setIntegerParam(15 motorUpdateStatus_)=0
=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.465 [motorDevSup.c:327  IOC_MTCA:Axis13] PositionRestoreNeeded IOC_MTCA:Axis13 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.465 [motorRecord.cc:782  IOC_MTCA:Axis13] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.465 [motorRecord.cc:720  IOC_MTCA:Axis13] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.465 [motorRecord.cc:833  IOC_MTCA:Axis13] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.465 [motorRecord.cc:968  IOC_MTCA:Axis13] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:439  IOC_MTCA:Axis14] init_record IOC_MTCA:Axis14 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.466 [devMotorAsyn.c:185  IOC_MTCA:Axis14] init_controller IOC_MTCA:Axis14 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:266  IOC_MTCA:Axis14] update_soft_limits IOC_MTCA:Axis14 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.466 [motorDevSup.c:327  IOC_MTCA:Axis14] PositionRestoreNeeded IOC_MTCA:Axis14 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.466 [motorRecord.cc:782  IOC_MTCA:Axis14] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.466 [motorRecord.cc:720  IOC_MTCA:Axis14] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.466 [motorRecord.cc:833  IOC_MTCA:Axis14] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.466 [motorRecord.cc:968  IOC_MTCA:Axis14] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:439  IOC_MTCA:Axis15] init_record IOC_MTCA:Axis15 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.466 [devMotorAsyn.c:185  IOC_MTCA:Axis15] init_controller IOC_MTCA:Axis15 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:266  IOC_MTCA:Axis15] update_soft_limits IOC_MTCA:Axis15 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.466 [motorDevSup.c:327  IOC_MTCA:Axis15] PositionRestoreNeeded IOC_MTCA:Axis15 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.466 [motorRecord.cc:782  IOC_MTCA:Axis15] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.466 [motorRecord.cc:720  IOC_MTCA:Axis15] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.466 [motorRecord.cc:833  IOC_MTCA:Axis15] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.466 [motorRecord.cc:968  IOC_MTCA:Axis15] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:439  IOC_MTCA:Axis16] init_record IOC_MTCA:Axis16 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.466 [devMotorAsyn.c:185  IOC_MTCA:Axis16] init_controller IOC_MTCA:Axis16 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:266  IOC_MTCA:Axis16] update_soft_limits IOC_MTCA:Axis16 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:2022/07/07 09:01:19.466 ecmcMotorRecord:: setIntegerParam(16 motorUpdateStatus_)=0
2022/07/07 09:01:19.466 ecmcMotorRecord:: setIntegerParam(17 motorUpdateStatus_)=0
2022/07/07 09:01:19.467 ecmcMotorRecord:: setIntegerParam(18 motorUpdateStatus_)=0
01:19.466 [motorDevSup.c:327  IOC_MTCA:Axis16] PositionRestoreNeeded IOC_MTCA:Axis16 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.466 [motorRecord.cc:782  IOC_MTCA:Axis16] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.466 [motorRecord.cc:720  IOC_MTCA:Axis16] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.466 [motorRecord.cc:833  IOC_MTCA:Axis16] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.466 [motorRecord.cc:968  IOC_MTCA:Axis16] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:439  IOC_MTCA:Axis17] init_record IOC_MTCA:Axis17 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.466 [devMotorAsyn.c:185  IOC_MTCA:Axis17] init_controller IOC_MTCA:Axis17 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:266  IOC_MTCA:Axis17] update_soft_limits IOC_MTCA:Axis17 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.466 [motorDevSup.c:327  IOC_MTCA:Axis17] PositionRestoreNeeded IOC_MTCA:Axis17 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.466 [motorRecord.cc:782  IOC_MTCA:Axis17] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.466 [motorRecord.cc:720  IOC_MTCA:Axis17] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.466 [motorRecord.cc:833  IOC_MTCA:Axis17] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.466 [motorRecord.cc:968  IOC_MTCA:Axis17] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.466 [devMotorAsyn.c:439  IOC_MTCA:Axis18] init_record IOC_MTCA:Axis18 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.466 [devMotorAsyn.c:185  IOC_MTCA:Axis18] init_controller IOC_MTCA:Axis18 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:266  IOC_MTCA:Axis18] update_soft_limits IOC_MTCA:Axis18 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.467 [motorDevSup.c:327  IOC_MTCA:Axis18] PositionRestoreNeeded IOC_MTCA:Axis18 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.467 [motorRecord.cc:782  IOC_MTCA:Axis18] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.467 [motorRecord.cc:720  IOC_MTCA:Axis18] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.467 [motorRecord.cc:833  IOC_MTCA:Axis18] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.467 [motorRecord.cc:968  IOC_MTCA:Axis18] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:439  IOC_MTCA:Axis19] init_record IOC_MTCA:Axis19 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.467 [devMotorAsyn.c:185  IOC_MTCA:Axis19] init_controller IOC_MTCA:Axis19 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:266  IOC_MTCA:Axis19] update_soft_limits IOC_MTCA:Axis19 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.467 [motorDevSup.c:327  IOC_MTCA:Axis19] PositionRestoreNeeded IOC_MTCA:Axis19 2022/07/07 09:01:19.467 ecmcMotorRecord:: setIntegerParam(19 motorUpdateStatus_)=0
2022/07/07 09:01:19.467 ecmcMotorRecord:: setIntegerParam(20 motorUpdateStatus_)=0
2022/07/07 09:01:19.467 ecmcMotorRecord:: setIntegerParam(21 motorUpdateStatus_)=0
rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.467 [motorRecord.cc:782  IOC_MTCA:Axis19] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.467 [motorRecord.cc:720  IOC_MTCA:Axis19] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.467 [motorRecord.cc:833  IOC_MTCA:Axis19] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.467 [motorRecord.cc:968  IOC_MTCA:Axis19] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:439  IOC_MTCA:Axis20] init_record IOC_MTCA:Axis20 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.467 [devMotorAsyn.c:185  IOC_MTCA:Axis20] init_controller IOC_MTCA:Axis20 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:266  IOC_MTCA:Axis20] update_soft_limits IOC_MTCA:Axis20 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.467 [motorDevSup.c:327  IOC_MTCA:Axis20] PositionRestoreNeeded IOC_MTCA:Axis20 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.467 [motorRecord.cc:782  IOC_MTCA:Axis20] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.467 [motorRecord.cc:720  IOC_MTCA:Axis20] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.467 [motorRecord.cc:833  IOC_MTCA:Axis20] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.467 [motorRecord.cc:968  IOC_MTCA:Axis20] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:439  IOC_MTCA:Axis21] init_record IOC_MTCA:Axis21 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.467 [devMotorAsyn.c:185  IOC_MTCA:Axis21] init_controller IOC_MTCA:Axis21 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:266  IOC_MTCA:Axis21] update_soft_limits IOC_MTCA:Axis21 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.467 [motorDevSup.c:327  IOC_MTCA:Axis21] PositionRestoreNeeded IOC_MTCA:Axis21 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.467 [motorRecord.cc:782  IOC_MTCA:Axis21] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.467 [motorRecord.cc:720  IOC_MTCA:Axis21] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.467 [motorRecord.cc:833  IOC_MTCA:Axis21] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.467 [motorRecord.cc:968  IOC_MTCA:Axis21] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:439  IOC_MTCA:Axis22] init_record IOC_MTCA:Axis22 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.467 [devMotorAsyn.c:185  IOC_MTCA:Axis22] init_controller IOC_MTCA:Axis22 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:266  IOC_MTCA:Axis22] update_soft_limits IOC_MTCA:Axis22 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.467 [motorDevSup.c:327  IOC_MTCA:Axis22] PositionRestoreNeeded IOC_MTCA:Axis22 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000002022/07/07 09:01:19.467 ecmcMotorRecord:: setIntegerParam(22 motorUpdateStatus_)=0
2022/07/07 09:01:19.468 ecmcMotorRecord:: setIntegerParam(23 motorUpdateStatus_)=0
2022/07/07 09:01:19.468 ecmcMotorRecord:: setIntegerParam(24 motorUpdateStatus_)=0
0 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.467 [motorRecord.cc:782  IOC_MTCA:Axis22] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.467 [motorRecord.cc:720  IOC_MTCA:Axis22] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.467 [motorRecord.cc:833  IOC_MTCA:Axis22] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.467 [motorRecord.cc:968  IOC_MTCA:Axis22] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.467 [devMotorAsyn.c:439  IOC_MTCA:Axis23] init_record IOC_MTCA:Axis23 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.468 [devMotorAsyn.c:185  IOC_MTCA:Axis23] init_controller IOC_MTCA:Axis23 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:266  IOC_MTCA:Axis23] update_soft_limits IOC_MTCA:Axis23 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.468 [motorDevSup.c:327  IOC_MTCA:Axis23] PositionRestoreNeeded IOC_MTCA:Axis23 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.468 [motorRecord.cc:782  IOC_MTCA:Axis23] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.468 [motorRecord.cc:720  IOC_MTCA:Axis23] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.468 [motorRecord.cc:833  IOC_MTCA:Axis23] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.468 [motorRecord.cc:968  IOC_MTCA:Axis23] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:439  IOC_MTCA:Axis24] init_record IOC_MTCA:Axis24 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.468 [devMotorAsyn.c:185  IOC_MTCA:Axis24] init_controller IOC_MTCA:Axis24 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:266  IOC_MTCA:Axis24] update_soft_limits IOC_MTCA:Axis24 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.468 [motorDevSup.c:327  IOC_MTCA:Axis24] PositionRestoreNeeded IOC_MTCA:Axis24 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.468 [motorRecord.cc:782  IOC_MTCA:Axis24] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.468 [motorRecord.cc:720  IOC_MTCA:Axis24] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.468 [motorRecord.cc:833  IOC_MTCA:Axis24] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.468 [motorRecord.cc:968  IOC_MTCA:Axis24] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:439  IOC_MTCA:Axis25] init_record IOC_MTCA:Axis25 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.468 [devMotorAsyn.c:185  IOC_MTCA:Axis25] init_controller IOC_MTCA:Axis25 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:266  IOC_MTCA:Axis25] update_soft_limits IOC_MTCA:Axis25 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.468 [motorDevSup.c:327  IOC_MTCA:Axis25] PositionRestoreNeeded IOC_MTCA:Axis25 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.468 [motorRe2022/07/07 09:01:19.468 ecmcMotorRecord:: setIntegerParam(25 motorUpdateStatus_)=0
2022/07/07 09:01:19.468 ecmcMotorRecord:: setIntegerParam(26 motorUpdateStatus_)=0
2022/07/07 09:01:19.468 ecmcMotorRecord:: setIntegerParam(27 motorUpdateStatus_)=0
cord.cc:782  IOC_MTCA:Axis25] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.468 [motorRecord.cc:720  IOC_MTCA:Axis25] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.468 [motorRecord.cc:833  IOC_MTCA:Axis25] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.468 [motorRecord.cc:968  IOC_MTCA:Axis25] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:439  IOC_MTCA:Axis26] init_record IOC_MTCA:Axis26 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.468 [devMotorAsyn.c:185  IOC_MTCA:Axis26] init_controller IOC_MTCA:Axis26 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:266  IOC_MTCA:Axis26] update_soft_limits IOC_MTCA:Axis26 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.468 [motorDevSup.c:327  IOC_MTCA:Axis26] PositionRestoreNeeded IOC_MTCA:Axis26 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.468 [motorRecord.cc:782  IOC_MTCA:Axis26] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.468 [motorRecord.cc:720  IOC_MTCA:Axis26] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.468 [motorRecord.cc:833  IOC_MTCA:Axis26] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.468 [motorRecord.cc:968  IOC_MTCA:Axis26] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:439  IOC_MTCA:Axis27] init_record IOC_MTCA:Axis27 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.468 [devMotorAsyn.c:185  IOC_MTCA:Axis27] init_controller IOC_MTCA:Axis27 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.468 [devMotorAsyn.c:266  IOC_MTCA:Axis27] update_soft_limits IOC_MTCA:Axis27 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.468 [motorDevSup.c:327  IOC_MTCA:Axis27] PositionRestoreNeeded IOC_MTCA:Axis27 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.468 [motorRecord.cc:782  IOC_MTCA:Axis27] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.468 [motorRecord.cc:720  IOC_MTCA:Axis27] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.468 [motorRecord.cc:833  IOC_MTCA:Axis27] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.468 [motorRecord.cc:968  IOC_MTCA:Axis27] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.469 [devMotorAsyn.c:439  IOC_MTCA:Axis28] init_record IOC_MTCA:Axis28 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.469 [devMotorAsyn.c:185  IOC_MTCA:Axis28] init_controller IOC_MTCA:Axis28 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.469 [devMotorAsyn.c:266  IOC_MTCA:Axis28] update_soft_limits IOC_MTCA:Axis28 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.469 [motorDevSup.c:327  IOC_MTCA:Axis28] PositionRestoreNeeded IOC_MTCA:Axis28 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.469 [motorRecord.cc:782  IOC_MTCA:Axis28] init_re_init start neverPolled=0 stat=17 nsta=0
2022/072022/07/07 09:01:19.469 ecmcMotorRecord:: setIntegerParam(28 motorUpdateStatus_)=0
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 1): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 2): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 3): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 4): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 5): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 6): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 7): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 8): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 9): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 10): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 11): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 12): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 13): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 14): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 15): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 16): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 17): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 18): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 19): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 20): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 21): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 22): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 23): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 24): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 25): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 26): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 27): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 28): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 29): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ../devEcmcSup/motion/ecmcAxisBase.cpp/preExecute:235: ERROR (axis 30): State change (ECMC_AXIS_STATE_DISABLED->ECMC_AXIS_STATE_STARTUP).
2022/07/07 09:01:19.469 ecmcMotorRecord:: setIntegerParam(29 motorUpdateStatus_)=0
2022/07/07 09:01:19.469 ecmcMotorRecord:: setIntegerParam(30 motorUpdateStatus_)=0
2022/07/07 09:01:19.470 ecmc::  30      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0      0  0  0  0 16 16  0  0 00  0  0  1  1  1  1  1
2022/07/07 09:01:19.473 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDatabase (7). Allow callbacks: true.
2022/07/07 09:01:19.473 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterFinishDevSup (8). Allow callbacks: true.
2022/07/07 09:01:19.489 ecmc::  30      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0.000      0      0  0  0  0  0 16  0  0 00  0  0  1  1  1  1  1
2022/07/07 09:01:19.982 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterScanInit (9). Allow callbacks: true.
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(1 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(2 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(3 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(4 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(5 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(6 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(7 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(8 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(9 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(10 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(11 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(12 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(13 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(14 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(15 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(16 HomPos_)=0.000000
2022/07/07 09:01:19.982 ecmcMotorRecord:: setDoubleParam(17 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(18 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(19 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(20 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(21 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(22 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(23 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(24 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(25 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(26 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(27 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(28 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(29 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setDoubleParam(30 HomPos_)=0.000000
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(1 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(2 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(3 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(4 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(5 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(6 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(7 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(8 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(9 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(10 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(11 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(12 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(13 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(14 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(15 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.983 ecmcMotorRecord:: setIntegerParam(16 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(17 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(18 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(19 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(20 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(21 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(22 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitialProcess (10). Allow callbacks: true.
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(23 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(24 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(25 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(26 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(27 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(28 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(29 HomProc_)=3 motorNotHomedProblem=0
2022/07/07 09:01:19.984 ecmcMotorRecord:: setIntegerParam(30 HomProc_)=3 motorNotHomedProblem=0
cas warning: Configured TCP port was unavailable.
cas warning: Using dynamically assigned TCP port 38103,
cas warning: but now two or more servers share the same UDP port.
cas warning: Depending on your IP kernel this server may not be
cas warning: reachable with UDP unicast (a host's IP in EPICS_CA_ADDR_LIST)
2022/07/07 09:01:19.985 ecmcAsynPortDriver:getEpicsState: EPICS state: Unknown state (11). Allow callbacks: true.
2022/07/07 09:01:19.985 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterIocBuilt (12). Allow callbacks: true.
2022/07/07 09:01:19.990 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtIocRun (13). Allow callbacks: true.
2022/07/07 09:01:19.990 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterDatabaseRunning (14). Allow callbacks: true.
2022/07/07 09:01:19.990 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInterruptAccept (28). Allow callbacks: true.
2022/07/07 09:01:19.990 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCaServerRunning (15). Allow callbacks: true.
2022/07/07 09:01:19.990 ecmcAsynPortDriver:getEpicsState: EPICS state: Unknown state (29). Allow callbacks: true.
iocRun: All initialization complete
/07 09:01:19.469 [motorRecord.cc:720  IOC_MTCA:Axis28] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.469 [motorRecord.cc:833  IOC_MTCA:Axis28] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.469 [motorRecord.cc:968  IOC_MTCA:Axis28] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.469 [devMotorAsyn.c:439  IOC_MTCA:Axis29] init_record IOC_MTCA:Axis29 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.469 [devMotorAsyn.c:185  IOC_MTCA:Axis29] init_controller IOC_MTCA:Axis29 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.469 [devMotorAsyn.c:266  IOC_MTCA:Axis29] update_soft_limits IOC_MTCA:Axis29 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.469 [motorDevSup.c:327  IOC_MTCA:Axis29] PositionRestoreNeeded IOC_MTCA:Axis29 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.469 [motorRecord.cc:782  IOC_MTCA:Axis29] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.469 [motorRecord.cc:720  IOC_MTCA:Axis29] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.469 [motorRecord.cc:833  IOC_MTCA:Axis29] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.469 [motorRecord.cc:968  IOC_MTCA:Axis29] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022/07/07 09:01:19.469 [devMotorAsyn.c:439  IOC_MTCA:Axis30] init_record IOC_MTCA:Axis30 position=0.000000 encoderPos=0.000000 velocity=0.000000 MSTAstatus=0x490a flagsValue=0x3f flagsWritten=0x3f pmr->mflg=0x0
2022/07/07 09:01:19.469 [devMotorAsyn.c:185  IOC_MTCA:Axis30] init_controller IOC_MTCA:Axis30 set encoder ratio=1.000000 status=0
2022/07/07 09:01:19.469 [devMotorAsyn.c:266  IOC_MTCA:Axis30] update_soft_limits IOC_MTCA:Axis30 RawHLM_RO=0.000000 RawLLM_RO=0.000000 valid=0 DHLM_RO=0.000000 DLLM_RO=0.000000
2022/07/07 09:01:19.469 [motorDevSup.c:327  IOC_MTCA:Axis30] PositionRestoreNeeded IOC_MTCA:Axis30 rstm=2 dval=0.000000 drbv=0.000000 pmr->rdbd=0.300000 rdbd=1.000000 pmr->mres=1.000000 pmr->mflg=0x3f dval_non_zero_pos_near_zero=0 ret=0
2022/07/07 09:01:19.469 [motorRecord.cc:782  IOC_MTCA:Axis30] init_re_init start neverPolled=0 stat=17 nsta=0
2022/07/07 09:01:19.469 [motorRecord.cc:720  IOC_MTCA:Axis30] enforceMinRetryDeadband spdb=0.300000 rdbd=0.300000 mres=1.000000
2022/07/07 09:01:19.469 [motorRecord.cc:833  IOC_MTCA:Axis30] init_re_init  end dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000
2022/07/07 09:01:19.469 [motorRecord.cc:968  IOC_MTCA:Axis30] init_record process_reason="callbackdata + soft limits" dval=0.000000 drbv=0.000000 rdbd=0.300000 spdb=0.300000 stat=0 msta=0x490a neverPolled=0
2022-07-07T09:01:19.992 Using dynamically assigned TCP port 58702.
2022/07/07 09:01:19.995 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterIocRunning (16). Allow callbacks: true.
##############################################################################
## Store Records to file
dbl > pvs.log
epicsEnvSet EPICS_DRIVER_PATH /home/anderssandstrom/sources/e3-ecmc/cellMods//base-7.0.6.1/require-4.0.0:/epics/base-7.0.6.1/require/4.0.0/siteMods
epicsEnvSet EPICS_DRIVER_PATH /home/anderssandstrom/sources/e3-ecmccfg/cellMods//base-7.0.6.1/require-4.0.0:/home/anderssandstrom/sources/e3-ecmc/cellMods//base-7.0.6.1/require-4.0.0:/epics/base-7.0.6.1/require/4.0.0/siteMods
# Set the IOC Prompt String One 
epicsEnvSet IOCSH_PS1 "lab-mot-ctrl-cp-25019 > "
#
<<<<<<< HEAD
[?1034hlab-mot-ctrl-cp-25019 > 
=======
[?1034hlab-mot-ctrl-cp-13804 > 
lab-mot-ctrl-cp-13804 > 
lab-mot-ctrl-cp-13804 > 
lab-mot-ctrl-cp-13804 > 
lab-mot-ctrl-cp-13804 > 
lab-mot-ctrl-cp-13804 > 
lab-mot-ctrl-cp-13804 > 
lab-mot-ctrl-cp-13804 > 
lab-mot-ctrl-cp-13804 > 
>>>>>>> d177605bb71304f2f108bb24cdb9de5f58674ef3
